!function(e){var t=function(){},i=t.prototype=new createjs.Container,n=!1,s=!1,a=null,r=0,o=0,l=null,u=0,h=null,c=null,d=-1,g=!1,p=0,_=0;t.VERSION="1.1.16",i.Container_initialize=i.initialize,i.stage=null,i._app=null,i.options=null,i._updateFunctions={},t.init=function(e,i){return c||(c=new t,c.initialize(e,i)),c},i.initialize=function(t,i){this.Container_initialize(),this.options=i||{},this.options.parseQueryString!==e&&(this.options=k(this.options)),this.options.debug!==e&&(Debug.enabled=this.options.debug===!0||"true"===this.options.debug),this.options.minLogLevel!==e&&(Debug.minLogLevel=parseInt(this.options.minLogLevel,10)),"string"==typeof this.options.ip&&Debug.connect(this.options.ip);var n=cloudkid.MediaLoader.init();this.stage=new createjs.Stage(t),this.stage.name="cloudkid.OS",this.stage.canvas.onmousedown=function(e){e.preventDefault()};var r=this.options.mouseOverRate=this.options.mouseOverRate||30;this.stage.enableMouseOver(r),this.stage.addChild(this),this.visibleListener=this.onWindowVisibilityChanged.bind(this),w(this.visibleListener);var o=window.hasOwnProperty("ontouchstart");(-1==window.navigator.userAgent.indexOf("MSIE 10.0")||o)&&createjs.Touch.enable(this.stage),this.stage.autoClear=!!this.options.clearView||!1,this.options.showFramerate&&(a=new createjs.Text("","10px Arial","#000"),a.stroke={width:2,color:"#ffffff"},a.x=a.y=5,this.addChild(a)),this.stage.update();if(h=this.tick.bind(this),g=this.options.raf||!1,this.fps=this.options.fps||60,this.removeApp(),this.options.versionsFile!==e){s=!1;var l=this;n.cacheManager.addVersionsFile(this.options.versionsFile,function(){s=!0,l._app&&(l.addChildAt(l._app,0),l._app.init(),l.resume())})}else s=!0};var f=null,m=null,b="visible",v="hidden",w=function(e){f="hidden",f in document?document.addEventListener("visibilitychange",e):(f="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(f="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(f="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?(m={focusin:b,focusout:v},document.onfocusin=document.onfocusout=e):(m={focus:b,pageshow:b,blur:v,pagehide:v},window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e)},y=function(e){var t="hidden";t in document?document.removeEventListener("visibilitychange",e):(t="mozHidden")in document?document.removeEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.removeEventListener("webkitvisibilitychange",e):(t="msHidden")in document&&document.removeEventListener("msvisibilitychange",e),document.onfocusin=document.onfocusout=null,window.onpageshow=window.onpagehide=window.onfocus=window.onblur=null};i.onWindowVisibilityChanged=function(e){var t="visible",i="hidden";e=e||window.event;var n;n=m?m[e.type]:document[f]?i:t,n==i?this.pause():this.resume()};var k=function(e){var t=window.location.href,i=t.indexOf("?");if(-1==i)return e;var n=0>i?"":t.substr(i+1),s=n.indexOf("#");n=0>s?n:n.substring(0,s);for(var a,r=n.split("&"),o=0;o<r.length;o++)a=r[o].split("="),e[a[0]]=a[1];return e};i.pause=function(){-1!=d&&(g?window.cancelAnimationFrame&&cancelAnimationFrame(d):clearTimeout(d),d=-1),n=!0};var S=window.performance&&(performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow);S=S?S.bind(performance):function(){return(new Date).getTime()},i.getTime=function(){return S()},i.resume=function(){n=!1,-1==d&&(d=g?requestAnimFrame(h):C(h)),o=r=this.getTime()},Object.defineProperty(i,"fps",{get:function(){return p},set:function(e){"number"==typeof e&&(p=e,_=1e3/p|0)}}),Object.defineProperty(i,"stageWidth",{get:function(){return c.stage.canvas.width}}),Object.defineProperty(i,"stageHeight",{get:function(){return c.stage.canvas.height}});var C=function(e,t){var i=0;return t&&(i=Math.max(0,_-t)),setTimeout(e,i)};i.removeApp=function(e){var t=!1,i=this.stage;return this._app&&(this.contains(this._app)&&this.removeChild(this._app),i.removeAllChildren(),this._app.destroy(),t=!0),this._app=null,this.pause(),e||(i.addChild(this),a&&(a.text="FPS: 0.000"),r=o=l=u=0,this.stage.update()),t},i.addApp=function(e){if(this.removeApp(),!(e instanceof cloudkid.Application))throw new Error("Can only objects that inherit cloudkid.Application");this._app=e,s&&(this.addChildAt(e,0),this._app.init(),this.resume())},i.getApp=function(){return this._app},i.addUpdateCallback=function(t,i){this._updateFunctions[t]===e&&(this._updateFunctions[t]=i)},i.removeUpdateCallback=function(t){this._updateFunctions[t]!==e&&delete this._updateFunctions[t]},i.tick=function(){if(n)return void(d=-1);var e=this.getTime(),t=e-r;if(a&&a.visible){u++;var i=e-o;i>1e3&&(l=1e3/i*u,a.text="FPS: "+Math.round(1e3*l)/1e3,o=e,u=0)}r=e,this._app&&this._app.update(t);for(var s in this._updateFunctions)this._updateFunctions[s](t);this.stage.update(t),d=g?requestAnimFrame(h):C(h,this.getTime()-r)},i.destroy=function(){var e=this.stage,t=cloudkid.MediaLoader.instance;this.pause(),this.removeApp(!0),c=null,createjs.Touch.disable(e),e.enableMouseOver(-1),e.enableDOMEvents(!1),t.destroy(),this.stage=null,this._updateFunctions=null,y(this.visibleListener)},Object.defineProperty(t,"instance",{get:function(){if(!c)throw"Call cloudkid.OS.init(canvasId)";return c}}),namespace("cloudkid").OS=t}(),function(e){"use strict";var t={};Function.prototype.bind||(t.bind=Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=Array.prototype.slice.call(arguments,1),n=function(){if(this instanceof n){var s=function(){};s.prototype=t.prototype;var a=new s,r=t.apply(a,i.concat(Array.prototype.slice.call(arguments)));return Object(r)===r?r:a}return t.apply(e,i.concat(Array.prototype.slice.call(arguments)))};return n});for(var i=0,n=["ms","moz","webkit","o"],s=0;s<n.length&&!e.requestAnimationFrame;++s)e.requestAnimationFrame=e[n[s]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[n[s]+"CancelAnimationFrame"]||e[n[s]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(t){var n=(new Date).getTime(),s=Math.max(0,16-(n-i)),a=e.setTimeout(function(){t(n+s)},s);return i=n+s,a},e.cancelAnimationFrame||(e.cancelAnimationFrame=function(e){clearTimeout(e)})),t.requestAnimationFrame=e.requestAnimationFrame,e.requestAnimFrame=e.requestAnimationFrame,t.cancelAnimationFrame=e.cancelAnimationFrame,namespace("cloudkid").FunctionUtils=t}(window),function(){"use strict";var e={};e.loadSpriteSheet=function(e,t,i){i>0||(i=1);for(var n in e){var s=e[n],a=n.indexOf(".");a>0&&(n=n.substring(0,a));var r=lib[n],o=lib[n]=function(){createjs.Container.call(this);var e=new createjs.Bitmap(this._image);this.addChild(e),e.sourceRect=this._frameRect;var t=this._scale;e.setTransform(this._frameOffsetX*t,this._frameOffsetY*t,t,t)},l=o.prototype=new createjs.Container;l._image=t,l._scale=i;var u=s.frame;l._frameRect=new createjs.Rectangle(u.x,u.y,u.w,u.h),s.trimmed?(l._frameOffsetX=s.spriteSourceSize.x,l._frameOffsetY=s.spriteSourceSize.y):l._frameOffsetX=l._frameOffsetY=0,l.nominalBounds=r&&r.prototype.nominalBounds?r.prototype.nominalBounds:new createjs.Rectangle(0,0,s.sourceSize.w,s.sourceSize.h)}},e.replaceWithScaledBitmap=function(e,t){if(1!=t&&t>0){var i,n,s,a;if("string"==typeof e)i=e,n=lib[i],n&&(s=lib[i]=function(){createjs.Container.call(this);var e=new this._oldBM;this.addChild(e),e.setTransform(0,0,this._scale,this._scale)},a=s.prototype=new createjs.Container,a._oldBM=n,a._scale=t,a.nominalBounds=n.prototype.nominalBounds);else for(i in e)n=lib[i],n&&(s=lib[i]=function(){createjs.Container.call(this);var e=new this._oldBM;this.addChild(e),e.setTransform(0,0,this._scale,this._scale)},a=s.prototype=new createjs.Container,a._oldBM=n,a._scale=t,a.nominalBounds=n.prototype.nominalBounds)}},namespace("cloudkid").BitmapUtils=e}(),function(){"use strict";var e={},t="undefined"!=typeof window.Storage,i=-1;if(t)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST")}catch(n){t=!1}e.remove=function(n){t?(localStorage.removeItem(n),sessionStorage.removeItem(n)):e.write(n,"",i)},e.write=function(e,n,s){if(t)s?sessionStorage.setItem(e,JSON.stringify(n)):localStorage.setItem(e,JSON.stringify(n));else{var a;a=s?s!==i?"":"; expires=Thu, 01 Jan 1970 00:00:00 GMT":"; expires="+new Date(2147483646e3).toGMTString(),document.cookie=e+"="+escape(JSON.stringify(n))+a+"; path=/"}},e.read=function(e){if(t){var i=localStorage.getItem(e)||sessionStorage.getItem(e);return i?JSON.parse(i):null}var n,s=e+"=",a=document.cookie.split(";"),r=0;for(r=0;r<a.length;r++){for(n=a[r];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(s))return JSON.parse(unescape(n.substring(s.length,n.length)))}return null},namespace("cloudkid").SavedData=e}(),function(){"use strict";window.URL=window.URL||window.webkitURL,window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;var Worker={};Worker.init=function(e){if(!window.URL||!window.Worker)return new FallbackWorker(e);var t;try{t=new Blob([e],{type:"application/javascript"})}catch(i){if(!window.BlobBuilder)return new FallbackWorker(e);try{t=new BlobBuilder,t.append(e),t=t.getBlob()}catch(n){return new FallbackWorker(e)}}if(!t)return new FallbackWorker(e);try{var s=new Worker(URL.createObjectURL(t));return s}catch(i){return new FallbackWorker(e)}},namespace("cloudkid").createWorker=Worker.init,namespace("cloudkid").Worker=Worker;var SubWorker=function(codeString,parent){this._wParent=parent,eval(codeString)},p=SubWorker.prototype;p.onmessage=null,p._wParent=null,p.postMessage=function(e){var t=this._wParent;setTimeout(t.onmessage.bind(t,{data:e}),1)};var FallbackWorker=function(e){this._wChild=new SubWorker(e,this)};p=FallbackWorker.prototype,p.postMessage=function(e){var t=this._wChild;setTimeout(t.onmessage.bind(t,{data:e}),1)},p.terminate=function(){this.onmessage=null;var e=this._wChild;e._wParent=null,e.onmessage=null,this._wChild=null},p.onmessage=null,p._wChild=null}(),function(){"use strict";var e=function(e,t,i,n){t[i]?t[n]=e:e()};e.create=function(t,i,n,s){return e.bind(this,t,i,n,s)},namespace("cloudkid").CombinedCallback=e}(),function(){"use strict";var e,t=function(){this.initialize()};e=t.prototype=new createjs.Container,e.init=function(){},e.update=function(){},e.destroy=function(){},e.resize=function(){},namespace("cloudkid").Application=t}(),function(){"use strict";var e=function(){},t=e.prototype;e.PRIORITY_HIGH=1,e.PRIORITY_NORMAL=0,e.PRIORITY_LOW=-1,t.url=null,t.data=null,t.callback=null,t.priority=0,t.progress=0,t.updateCallback=null,t._boundFail=null,t._boundProgress=null,t._boundComplete=null,t.toString=function(){return"[LoaderQueueItem(url:'"+this.url+"', priority:"+this.priority+")]"},t.destroy=function(){this.callback=null,this.updateCallback=null,this.data=null,this._boundFail=null,this._boundProgress=null,this._boundComplete=null},namespace("cloudkid").LoaderQueueItem=e}(),function(){"use strict";var e=function(){},t=e.prototype;e._instance=null;var n=null,s=null,a=null,r=null,o=null,l=null,u=0,h=null;t._canLoad=!0,t.maxSimultaneousLoads=2,t.cacheManager=null,e.init=function(){return e._instance||(e._instance=new e,e._instance._initialize()),e._instance},Object.defineProperty(e,"instance",{get:function(){if(!e._instance)throw"Call cloudkid.MediaLoader.init()";return e._instance}}),t.destroy=function(){var t,i,u,c=this.queue;if(c){for(t=0,i=c.length;t>t;++t)c[t].destroy();for(c=r,t=0,i=c.length;t>t;++t)c[t].destroy();for(c=l,t=0,i=c.length;t>t;++t)c[t].destroy();for(u in a)s[u].destroy(),a[u].close()}e._instance=null,this.cacheManager&&this.cacheManager.destroy(),this.cacheManager=null,n=null,l=null,o=null,r=null,s=null,h=null,a=null},t._initialize=function(){r=[],o=[],l=[],n=[],s={},a={},h={},this.cacheManager=new cloudkid.CacheManager},t.load=function(e,t,i,s,a){var r=this._getQI(),o=cloudkid.OS.instance.options.basePath;void 0!==o&&/^http(s)?\:/.test(e)===!1&&-1==e.search(o)&&(r.basePath=o),r.url=e,r.callback=t,r.updateCallback=i||null,r.priority=s||cloudkid.LoaderQueueItem.PRIORITY_NORMAL,r.data=a||null,n.push(r),n.sort(function(e,t){return e.priority-t.priority}),this._tryNextLoad()},t._onLoadFailed=function(e,t){Debug.error("Unable to load file: "+e.url+" - reason: "+t.error);var i=a[e.url];i.removeAllEventListeners(),i.close(),this._poolLoader(i),delete s[e.url],delete a[e.url],h[e.url]?h[e.url]++:h[e.url]=1,h[e.url]>3?this._loadDone(e,null):(u--,n.push(e),this._tryNextLoad())},t._onLoadProgress=function(e,t){e.progress=t.progress,e.updateCallback&&e.updateCallback(e.progress)},t._onLoadCompleted=function(e,t){var i=a[e.url];i.removeAllEventListeners(),i.close(),this._poolLoader(i),delete s[e.url],delete a[e.url],this._loadDone(e,this._getResult(t.result,e.url,i))},t._tryNextLoad=function(){if(!(u>this.maxSimultaneousLoads-1||0===n.length)){u++;var e=n.shift();s[e.url]=e;var t=this._getLoader(e.basePath);a[e.url]=t,t.addEventListener("fileload",e._boundComplete),t.addEventListener("error",e._boundFail),t.addEventListener("fileprogress",e._boundProgress);var i=this.cacheManager.prepare(e.url);t.loadFile(e.data?{id:e.data.id,src:i,data:e.data}:i)}},t._loadDone=function(e,t){u--,e.data&&t&&(t.id=e.data.id),e.callback(t),this._poolQI(e),this._tryNextLoad()},t.cancel=function(e){var t=s[e],r=a[e];if(t&&r)return r.close(),delete a[e],delete s[t.url],u--,this._poolLoader(r),this._poolQI(t),!0;for(i=0,len=n.length;len>i;i++)if(t=n[i],t.url==e)return n.splice(i,1),this._poolQI(t),!0;return!1},t._getQI=function(){var e;return r.length?e=r.pop():(e=new cloudkid.LoaderQueueItem,e._boundFail=this._onLoadFailed.bind(this,e),e._boundProgress=this._onLoadProgress.bind(this,e),e._boundComplete=this._onLoadCompleted.bind(this,e)),e},t._poolQI=function(e){r.push(e),e.callback=e.updateCallback=e.data=e.url=null,e.progress=0},t._getLoader=function(e){var t;return o.length?(t=o.pop(),t._basePath=e):t=new createjs.LoadQueue(!0,e),createjs.Sound&&t.installPlugin(createjs.Sound),t},t._poolLoader=function(e){e.removeAll(),o.push(e)},t._getResult=function(e,t,i){var n;return l.length?(n=l.pop(),n.content=e,n.url=t,n.loader=i):n=new cloudkid.MediaLoaderResult(e,t,i),n},t._poolResult=function(e){e.content=e.url=e.loader=e.id=null,l.push(e)},namespace("cloudkid").MediaLoader=e}(),function(){"use strict";var e=function(e,t,i){this.content=e,this.url=t,this.loader=i},t=e.prototype;t.content=null,t.url=null,t.loader=null,t.toString=function(){return"[MediaLoaderResult('"+this.url+"')]"},t.destroy=function(){this.callback=null,this.url=null,this.content=null},namespace("cloudkid").MediaLoaderResult=e}(),function(e){"use strict";var t=function(){this.initialize()},i=t.prototype={};i._versions=null,i.cacheBust=!1,i.initialize=function(){this._versions=[];var e=cloudkid.OS.instance.options.cacheBust;this.cacheBust=e?"true"===e||e===!0:!1},i.destroy=function(){this._versions=null},i.addVersionsFile=function(e,t,i){Debug.assert(/^.*\.txt$/.test(e),"The versions file must be a *.txt file");var n=cloudkid.MediaLoader.instance;if(this.cacheBust)return void(t&&t());this.addVersion(e,Math.round(1e5*Math.random()));var s=this;n.load(e,function(e){if(e&&e.content){var n,a,r=e.content.replace(/\r/g,"").split("\n");for(n=0;n<r.length;n++)r[n]&&(a=r[n].split(" "),2==a.length&&s.addVersion((i||"")+a[0],a[1]))}t&&t()})},i.addVersion=function(e,t){var i=this._getVersionByUrl(e);i||this._versions.push({url:e,version:t})},i._getVersionByUrl=function(e){var t,i=this._versions.length;for(t=0;i>t;t++)if(e==this._versions[t].url)return this._versions[t];return null},i.prepare=function(t,i){var n=this._getVersionByUrl(t);if(this.cacheBust&&/(\?|\&)cb\=[0-9]*/.test(t)===!1?(this._cbVal||(this._cbVal=(new Date).getTime().toString()),t=t+(t.indexOf("?")<0?"?":"&")+"cb="+this._cbVal):n&&/(\?|\&)v\=[0-9]*/.test(t)===!1&&(t=t+(t.indexOf("?")<0?"?":"&")+"v="+n.version),i){var s=cloudkid.OS.instance.options.basePath;/^http(s)?\:/.test(t)===!1&&s!==e&&-1==t.search(s)&&(t=s+t)}return t},namespace("cloudkid").CacheManager=t}(),function(e){"use strict";function t(e){if(!e||"object"!=typeof e)return null;var t=e.constructor();for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}var i=function(e,t,i){e&&this.initialize(e,t,i)},n=i.prototype=new createjs.Container,s=createjs.Container.prototype;n.back=null,n.label=null,n._overCB=null,n._outCB=null,n._downCB=null,n._upCB=null,n._stateFlags=null,n._statePriority=null,n._stateData=null,n._width=0,n._height=0,i.BUTTON_PRESS="buttonPress";var a=["disabled","enabled","up","over","down"],r=["disabled","up","over","down"];n.initialize=function(i,n,a){s.initialize.call(this),this.mouseChildren=!1,this._downCB=this._onMouseDown.bind(this),this._upCB=this._onMouseUp.bind(this),this._overCB=this._onMouseOver.bind(this),this._outCB=this._onMouseOut.bind(this);var o=this._stateData={};this._stateFlags={};var l;n&&(l=t(n),delete l.text,l.x===e&&(l.x="center"),l.y===e&&(l.y="center"));var u,h,c,d,g;if(i.image){for(u=i.image,this._statePriority=i.priority||r,d=this._statePriority.length-1;d>=0;--d){g=this._statePriority[d],this._addProperty(g),"disabled"!=g&&"up"!=g&&(this._stateFlags[g]=!1);var p=i[g];if(o[g]=p?t(p):o.up,n)if(p&&p.label){p=p.label;var _=o[g].label={};_.font=p.font||l.font,_.color=p.color||l.color,_.stroke=p.stroke||l.stroke,_.shadow=p.shadow||l.shadow,_.textBaseline=p.textBaseline||l.textBaseline,_.x=p.x||l.x,_.y=p.y||l.y}else o[g].label=l}if(o.up.trim){var f=o.up.trim;h=f.width,c=f.height}else h=o.up.src.width,c=o.up.src.height;o.up||(Debug.error("Button lacks an up state! This is a serious problem! Input data follows:"),Debug.error(i)),o.over||(o.over=o.up),o.down||(o.down=o.up),o.disabled||(o.disabled=o.up)}else u=i,h=u.width,c=u.height/3,this._statePriority=r,o.disabled=o.up={src:new createjs.Rectangle(0,0,h,c)},o.over={src:new createjs.Rectangle(0,c,h,c)},o.down={src:new createjs.Rectangle(0,2*c,h,c)};this.back=new createjs.Bitmap(u),this.addChild(this.back),this._width=h,this._height=c,n&&(this.label=new createjs.Text(n.text||"",o.up.label.font,o.up.label.color),this.addChild(this.label)),this.enabled=a===e?!0:!!a},Object.defineProperty(n,"width",{get:function(){return this._width*this.scaleX},set:function(e){this.scaleX=e/this._width}}),Object.defineProperty(n,"height",{get:function(){return this._height*this.scaleY},set:function(e){this.scaleY=e/this._height}}),n.setText=function(e){if(this.label){this.label.text=e;for(var t,i=0;i<this._statePriority.length;++i)if(this._stateFlags[this._statePriority[i]]){t=this._stateData[this._statePriority[i]];break}t||(t=this._stateData.up),t=t.label,this.label.x="center"==t.x?.5*(width-this.label.getMeasuredWidth()):t.x,this.label.y="center"==t.y?.5*(height-this.label.getMeasuredLineHeight()):label.y}},Object.defineProperty(n,"enabled",{get:function(){return!this._stateFlags.disabled},set:function(e){this._stateFlags.disabled=!e,e?(this.cursor="pointer",this.addEventListener("mousedown",this._downCB),this.addEventListener("mouseover",this._overCB),this.addEventListener("mouseout",this._outCB)):(this.cursor=null,this.removeEventListener("mousedown",this._downCB),this.removeEventListener("mouseover",this._overCB),this.removeEventListener("mouseout",this._outCB),this._stateFlags.down=this._stateFlags.over=!1),this._updateState()}}),n._addProperty=function(e){a.indexOf(e>=0)||Object.defineProperty(this,e,{get:function(){return this._stateFlags[e]},set:function(t){this._stateFlags[e]=t,this._updateState()}})},n._updateState=function(){if(this.back){for(var e,t=0;t<this._statePriority.length;++t)if(this._stateFlags[this._statePriority[t]]){e=this._stateData[this._statePriority[t]];break}e||(e=this._stateData.up),this.back.sourceRect=e.src,e.trim?(this.back.x=e.trim.x,this.back.y=e.trim.y):this.back.x=this.back.y=0,this.label&&(e=e.label,this.label.textBaseline=e.textBaseline||"top",this.label.stroke=e.stroke,this.label.shadow=e.shadow,this.label.font=e.font,this.label.color=e.color||"#000",this.label.x="center"==e.x?.5*(width-this.label.getMeasuredWidth()):e.x,this.label.y="center"==e.y?.5*(height-this.label.getMeasuredLineHeight()):label.y)}},n._onMouseDown=function(){this.addEventListener("pressup",this._upCB),this._stateFlags.down=!0,this._updateState()},n._onMouseUp=function(){this.removeEventListener("pressup",this._upCB),this._stateFlags.down=!1,this._stateFlags.over&&this.dispatchEvent(new createjs.Event(i.BUTTON_PRESS)),this._updateState()},n._onMouseOver=function(){this._stateFlags.over=!0,this._updateState()},n._onMouseOut=function(){this._stateFlags.over=!1,this._updateState()},n.destroy=function(){this.removeAllChildren(),this.removeAllEventListeners(),this._downCB=null,this._upCB=null,this._overCB=null,this._outCB=null,this.back=null,this.label=null},i.generateDefaultStates=function(t,i,n){var s=t.width,a=t.height/3,o=document.createElement("canvas"),l=s,u=t.height;i&&(u+=a),n&&(l+=2*n.size,u+=a+2*n.size),o.width=l,o.height=u;var h=o.getContext("2d");h.drawImage(t,0,0);var c={image:o,up:{src:new createjs.Rectangle(0,0,s,a)},over:{src:new createjs.Rectangle(0,a,s,a)},down:{src:new createjs.Rectangle(0,2*a,s,a)}},d=new createjs.Bitmap(t);d.sourceRect=c.up.src;var g=t.height;if(i){h.save(),h.translate(0,g);var p=new createjs.ColorMatrix;i.saturation!==e&&p.adjustSaturation(i.saturation),i.brightness!==e&&p.adjustBrightness(2.55*i.brightness),i.contrast!==e&&p.adjustContrast(i.contrast),d.filters=[new createjs.ColorMatrixFilter(p)],d.cache(0,0,c.up.src.width,c.up.src.height),d.draw(h),c.disabled={src:new createjs.Rectangle(0,g,s,a)},g+=a,h.restore()}if(n){h.save();var _=s+2*n.size,f=a+2*n.size;d.filters=[new createjs.ColorFilter(0,0,0,1,n.red,n.green,n.blue,n.alpha!==e?-255+n.alpha:0)],d.scaleX=_/s,d.scaleY=f/a,d.x=0,d.y=g,d.cache(0,0,_,f),d.updateContext(h),d.draw(h),h.restore(),d.scaleX=d.scaleY=1,d.x=n.size,d.y=g+n.size,d.filters=null,d.uncache(),d.updateContext(h),d.draw(h);var m=new createjs.Rectangle(n.size,n.size,_,f);c.up.trim=m,c.over.trim=m,c.down.trim=m,c.disabled&&(c.disabled.trim=m),c.highlighted={src:new createjs.Rectangle(0,g,_,f)},c.priority=r.slice(),c.priority.unshift("highlight")}return c},namespace("cloudkid").Button=i}(),function(){"use strict";var e=function(e,t){this.initialize(e,t)},t=e.prototype={};t._updateCallback=null,t.draggedObj=null,t._dragOffset=null,t.dragStartThreshold=20,t.mouseDownStagePos=null,t.mouseDownObjPos=null,t.isTouchMove=!1,t.isHeldDrag=!1,t.isStickyClick=!1,t._theStage=null,t._dragStartCallback=null,t._dragEndCallback=null,t._triggerHeldDragCallback=null,t._triggerStickyClickCallback=null,t._stageMouseUpCallback=null,t._draggableObjects=null,t.initialize=function(e,t){this._updateCallback=this._updateObjPosition.bind(this),this._triggerHeldDragCallback=this._triggerHeldDrag.bind(this),this._triggerStickyClickCallback=this._triggerStickyClick.bind(this),this._stageMouseUpCallback=this._stopDrag.bind(this),this._theStage=cloudkid.OS.instance.stage,this._dragStartCallback=e,this._dragEndCallback=t,this._draggableObjects=[],this.mouseDownStagePos={x:0,y:0},this.mouseDownObjPos={x:0,y:0}},t.startDrag=function(e,t){this._objMouseDown(t,e)},t._objMouseDown=function(e,t){null===this.draggedObj&&(this.draggedObj=t,createjs.Tween.removeTweens(t),this._dragOffset=this.draggedObj.parent.globalToLocal(e?e.stageX:0,e?e.stageY:0),this._dragOffset.x-=t.x,this._dragOffset.y-=t.y,this.mouseDownObjPos.x=t.x,this.mouseDownObjPos.y=t.y,e?(this._theStage._getPointerData(e.pointerID).target=t,"touchstart"==e.nativeEvent.type?(this.mouseDownStagePos.x=e.stageX,this.mouseDownStagePos.y=e.stageY,this.isTouchMove=!0,this.isHeldDrag=!0,this._startDrag()):(this.mouseDownStagePos.x=e.stageX,this.mouseDownStagePos.y=e.stageY,t.addEventListener("pressmove",this._triggerHeldDragCallback),t.addEventListener("pressup",this._triggerStickyClickCallback))):(this.isHeldDrag=!0,this._startDrag()))},t._triggerStickyClick=function(){this.isStickyClick=!0,this.draggedObj.removeEventListener("pressmove",this._triggerHeldDragCallback),this.draggedObj.removeEventListener("pressup",this._triggerStickyClickCallback),this._startDrag()},t._triggerHeldDrag=function(e){var t=e.stageX-this.mouseDownStagePos.x,i=e.stageY-this.mouseDownStagePos.y;t*t+i*i>=this.dragStartThreshold*this.dragStartThreshold&&(this.isHeldDrag=!0,this.draggedObj.removeEventListener("pressmove",this._triggerHeldDragCallback),this.draggedObj.removeEventListener("pressup",this._triggerStickyClickCallback),this._startDrag())},t._startDrag=function(){var e=this._theStage;e.removeEventListener("stagemousemove",this._updateCallback),e.addEventListener("stagemousemove",this._updateCallback),e.removeEventListener("stagemouseup",this._stageMouseUpCallback),e.addEventListener("stagemouseup",this._stageMouseUpCallback),this._dragStartCallback(this.draggedObj)},t.stopDrag=function(e){this._stopDrag(null,e===!0)},t._stopDrag=function(e,t){var i=this.draggedObj;i.removeEventListener("pressmove",this._triggerHeldDragCallback),i.removeEventListener("pressup",this._triggerStickyClickCallback),this._theStage.removeEventListener("stagemousemove",this._updateCallback),this._theStage.removeEventListener("stagemouseup",this._stageMouseUpCallback),this.draggedObj=null,this.isTouchMove=!1,this.isStickyClick=!1,this.isHeldMove=!1,t!==!1&&this._dragEndCallback(i)},t._updateObjPosition=function(e){if(this.isTouchMove||this._theStage.mouseInBounds){var t=this.draggedObj.parent.globalToLocal(e.stageX,e.stageY),n=this.draggedObj._dragBounds;this.draggedObj.x=i(t.x-this._dragOffset.x,n.x,n.right),this.draggedObj.y=i(t.y-this._dragOffset.y,n.y,n.bottom)}};var i=function(e,t,i){return t>e?t:e>i?i:e},n=function(){this.addEventListener("mousedown",this._onMouseDownListener),this.cursor="pointer"},s=function(){this.removeEventListener("mousedown",this._onMouseDownListener),this.cursor=null},a=function(e){this._dragMan._objMouseDown(e,this)};t.addObject=function(e,t){t||(t={x:0,y:0,width:this._theStage.canvas.width,height:this._theStage.canvas.height}),t.right=t.x+t.width,t.bottom=t.y+t.height,e._dragBounds=t,this._draggableObjects.indexOf(e)>=0||(e.enableDrag=n,e.disableDrag=s,e._onMouseDownListener=a.bind(e),e._dragMan=this,this._draggableObjects.push(e))},t.removeObject=function(e){e.disableDrag(),delete e.enableDrag,delete e.disableDrag,delete e._onMouseDownListener,delete e._dragMan,delete e._dragBounds;var t=this._draggableObjects.indexOf(e);t>=0&&this._draggableObjects.splice(t,1)},t.destroy=function(){null!==this.draggedObj&&(this.draggedObj.removeEventListener("pressmove",this._triggerHeldDragCallback),this.draggedObj.removeEventListener("pressup",this._triggerStickyClickCallback),this._theStage.removeEventListener("stagemousemove",this._updateCallback),this.draggedObj=null),this._updateCallback=null,this._dragStartCallback=null,this._dragEndCallback=null,this._triggerHeldDragCallback=null,this._triggerStickyClickCallback=null,this._stageMouseUpCallback=null,this._theStage=null;for(var e=this._draggableObjects.length-1;e>=0;--e){var t=this._draggableObjects[e];t.disableDrag(),delete t.enableDrag,delete t.disableDrag,delete t._onMouseDownListener,delete t._dragMan,delete t._dragBounds}this._draggableObjects=null},namespace("cloudkid").DragManager=e}(),function(){"use strict";var e=function(){};e.prototype={},e.positionItems=function(t,i){var n,s;for(var a in i){var r=t[a];if(r){var o=i[a];if(r.x=o.x,r.y=o.y,s=o.scale,s&&(r.scaleX*=s.x,r.scaleY*=s.y),s=o.pivot,s&&(r.regX=s.x,r.regY=s.y),n=o.rotation,n&&(r.rotation=n),o.hitArea){var l=o.hitArea;r.hitShape=e.generateHitArea(l)}}else Debug.error("could not find object '"+a+"'")}},e.generateHitArea=function(e,i){i||(i=1);var n;if(n=window.createjs,t(e)){if(1==i)return new n.Polygon(e);for(var s=[],a=0,r=e.length;r>a;++a)s.push(new n.Point(e[a].x*i,e[a].y*i));return new n.Polygon(s)}return"rect"!=e.type&&e.type?"ellipse"==e.type?new n.Ellipse((e.x-.5*e.w)*i,(e.y-.5*e.h)*i,e.w*i,e.h*i):"circle"==e.type?new n.Circle(e.x*i,e.y*i,e.r*i):null:new n.Rectangle(e.x*i,e.y*i,e.w*i,e.h*i)};var t=function(e){return"[object Array]"===Object.prototype.toString.call(e)};namespace("cloudkid").Positioner=e}(),function(){"use strict";var e=function(e,t,i){this.width=e,this.height=t,this.ppi=i};e.prototype={},namespace("cloudkid").ScreenSettings=e}(),function(){"use strict";var e,t=function(t,i,n){switch(e=cloudkid.UIScaler,this._item=t,this._settings=i,this._designedScreen=n,this.origScaleX=t.scaleX,this.origScaleY=t.scaleY,this.origWidth=t.width,this.origBounds={x:0,y:0,width:t.width,height:t.height},this.origBounds.right=this.origBounds.x+this.origBounds.width,this.origBounds.bottom=this.origBounds.y+this.origBounds.height,i.vertAlign){case e.ALIGN_TOP:this.origMarginVert=t.y+this.origBounds.y;break;case e.ALIGN_CENTER:this.origMarginVert=.5*n.height-t.y;break;case e.ALIGN_BOTTOM:this.origMarginVert=n.height-(t.y+this.origBounds.bottom)}switch(i.horiAlign){case e.ALIGN_LEFT:this.origMarginHori=t.x+this.origBounds.x;break;case e.ALIGN_CENTER:this.origMarginHori=.5*n.width-t.x;break;case e.ALIGN_RIGHT:this.origMarginHori=n.width-(t.x+this.origBounds.right)}},i=t.prototype={};i.origMarginHori=0,i.origMarginVert=0,i.origWidth=0,i.origScaleX=0,i.origScaleY=0,i.origBounds=null,i._settings=null,i._item=null,i._designedScreen=null,i.resize=function(t){var i=t.height/this._designedScreen.height,n=t.ppi/this._designedScreen.ppi,s=(t.width-this._designedScreen.width*i)/2,a=i/n;this._settings.minScale&&a<this._settings.minScale?a=this._settings.minScale:this._settings.maxScale&&a>this._settings.maxScale&&(a=this._settings.maxScale),a*=n,this._item.scaleX=this.origScaleX*a,this._item.scaleY=this.origScaleY*a;var r;switch(r=this.origMarginVert*i,this._settings.vertAlign){case e.ALIGN_TOP:this._item.y=r-this.origBounds.y*a;break;case e.ALIGN_CENTER:this._item.y=.5*t.height-r;break;case e.ALIGN_BOTTOM:this._item.y=t.height-r-this.origBounds.bottom*a}switch(r=this.origMarginHori*i,this._settings.horiAlign){case e.ALIGN_LEFT:this._item.x=this._settings.titleSafe?s+r-this.origBounds.x*a:r-this.origBounds.x*a;break;case e.ALIGN_CENTER:this._item.x=this._settings.centeredHorizontally?.5*(t.width-this._item.width):.5*t.width-r;break;case e.ALIGN_RIGHT:this._item.x=this._settings.titleSafe?t.width-s-r-this.origBounds.right*a:t.width-r-this.origBounds.right*a}},i.destroy=function(){this.origBounds=null,this._item=null,this._settings=null,this._designedScreen=null},namespace("cloudkid").UIElement=t}(),function(){"use strict";var e=function(){},t=e.prototype={};t.vertAlign=null,t.horiAlign=null,t.titleSafe=!1,t.maxScale=1,t.minScale=1,t.centeredHorizontally=!1,namespace("cloudkid").UIElementSettings=e}(),function(){"use strict";var e=cloudkid.UIElementSettings,t=cloudkid.UIElement,i=cloudkid.ScreenSettings,n=function(e,t,n,s){this._parent=e,this._items=[],this._designedScreen=new i(t,n,s)},s=n.prototype={},a=new i(0,0,0),r=!1;s._parent=null,s._designedScreen=null,s._items=null,n.ALIGN_TOP="top",n.ALIGN_BOTTOM="bottom",n.ALIGN_LEFT="left",n.ALIGN_RIGHT="right",n.ALIGN_CENTER="center",n.fromJSON=function(e,t,i,s){"boolean"!=typeof s&&(s=!0);var a,r,o,l,u,h=new n(e,t.designedWidth,t.designedHeight,t.designedPPI);for(r in i)a=i[r],a.align?(o=a.align.split("-"),l=o[0],u=o[1]):(l=ALIGN_CENTER,u=ALIGN_CENTER),h.add(e[r],l,u,a.titleSafe||!1,a.minScale||0/0,a.maxScale||0/0,a.centeredHorizontally||!1);return h.resize(),s&&h.destroy(),h},n.init=function(e,t,i){a.width=e,a.height=t,a.ppi=i,r=!0},s.getScale=function(){return a.height/this._designedScreen.height},s.add=function(i,s,a,r,o,l,u){var h=new e;h.vertAlign=s||n.ALIGN_CENTER,h.horiAlign=a||n.ALIGN_CENTER,h.titleSafe="boolean"!=typeof r?!1:r,h.maxScale="number"!=typeof l?0/0:l,h.minScale="number"!=typeof o?0/0:o,h.centeredHorizontally=u||!1,this._items.push(new t(i,h,this._designedScreen))},n.resizeBackground=function(e){if(r){var t,i,n;t=e.image.height,i=e.image.width,n=a.height/t,e.scaleX=e.scaleY=n,e.x=.5*(a.width-i*n)}},n.resizeBackgrounds=function(e){for(var t=0,i=e.length;i>t;++t)n.resizeBackground(e[t])
},s.resize=function(){if(this._items.length>0)for(var e=0,t=this._items.length;t>e;++e)this._items[e].resize(a)},s.destroy=function(){if(this._items.length>0)for(var e=0,t=this._items.length;t>e;++e)this._items[e].destroy();this._parent=null,this._designedScreen=null,this._items=null},namespace("cloudkid").UIScaler=n}();