!function(t){var e=function(){},i=e.prototype=new createjs.Container,s=!1,n=!1,a=null,r=0,o=0,l=null,h=0,u=null,d=null,c=-1,g=!1,p=0,_=0;e.VERSION="1.1.24",i.Container_initialize=i.initialize,i.stage=null,i._app=null,i.options=null,i._updateFunctions={},e.init=function(t,i){return d||(d=new e,d.initialize(t,i)),d},i.initialize=function(e,i){this.Container_initialize(),this.options=i||{},this.options.parseQueryString!==t&&(this.options=k(this.options)),this.options.debug!==t&&(Debug.enabled=this.options.debug===!0||"true"===this.options.debug),this.options.minLogLevel!==t&&(Debug.minLogLevel=parseInt(this.options.minLogLevel,10)),"string"==typeof this.options.ip&&Debug.connect(this.options.ip);var s=cloudkid.MediaLoader.init();this.stage=new createjs.Stage(e),this.stage.name="cloudkid.OS",this.stage.canvas.onmousedown=function(t){t.preventDefault()};var r=this.options.mouseOverRate=this.options.mouseOverRate||30;this.stage.enableMouseOver(r),this.stage.addChild(this),this.visibleListener=this.onWindowVisibilityChanged.bind(this),w(this.visibleListener);var o=window.hasOwnProperty("ontouchstart");(-1==window.navigator.userAgent.indexOf("MSIE 10.0")||o)&&createjs.Touch.enable(this.stage),this.stage.autoClear=!!this.options.clearView||!1,this.options.showFramerate&&(a=new createjs.Text("","10px Arial","#000"),a.stroke={width:2,color:"#ffffff"},a.x=a.y=5,this.addChild(a)),this.stage.update();if(u=this.tick.bind(this),g=this.options.raf||!1,this.fps=this.options.fps||60,this.removeApp(),this.options.versionsFile!==t){n=!1;var l=this;s.cacheManager.addVersionsFile(this.options.versionsFile,function(){n=!0,l._app&&(l.addChildAt(l._app,0),l._app.init(),l.resume())})}else n=!0};var f=null,m=null,b="visible",v="hidden",w=function(t){f="hidden",f in document?document.addEventListener("visibilitychange",t):(f="mozHidden")in document?document.addEventListener("mozvisibilitychange",t):(f="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",t):(f="msHidden")in document?document.addEventListener("msvisibilitychange",t):"onfocusin"in document?(m={focusin:b,focusout:v},document.onfocusin=document.onfocusout=t):(m={focus:b,pageshow:b,blur:v,pagehide:v},window.onpageshow=window.onpagehide=window.onfocus=window.onblur=t)},y=function(t){var e="hidden";e in document?document.removeEventListener("visibilitychange",t):(e="mozHidden")in document?document.removeEventListener("mozvisibilitychange",t):(e="webkitHidden")in document?document.removeEventListener("webkitvisibilitychange",t):(e="msHidden")in document&&document.removeEventListener("msvisibilitychange",t),document.onfocusin=document.onfocusout=null,window.onpageshow=window.onpagehide=window.onfocus=window.onblur=null};i.onWindowVisibilityChanged=function(t){var e="visible",i="hidden";t=t||window.event;var s;s=m?m[t.type]:document[f]?i:e,s==i?this.pause():this.resume()};var k=function(t){var e=window.location.href,i=e.indexOf("?");if(-1==i)return t;var s=0>i?"":e.substr(i+1),n=s.indexOf("#");s=0>n?s:s.substring(0,n);for(var a,r=s.split("&"),o=0;o<r.length;o++)a=r[o].split("="),t[a[0]]=a[1];return t};i.pause=function(){-1!=c&&(g?window.cancelAnimationFrame&&cancelAnimationFrame(c):clearTimeout(c),c=-1),s=!0};var S=window.performance&&(performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow);S=S?S.bind(performance):function(){return(new Date).getTime()},i.getTime=function(){return S()},i.resume=function(){s=!1,-1==c&&(c=g?requestAnimFrame(u):C(u)),o=r=this.getTime()},Object.defineProperty(i,"fps",{get:function(){return p},set:function(t){"number"==typeof t&&(p=t,_=1e3/p|0)}}),Object.defineProperty(i,"stageWidth",{get:function(){return d.stage.canvas.width}}),Object.defineProperty(i,"stageHeight",{get:function(){return d.stage.canvas.height}});var C=function(t,e){var i=0;return e&&(i=Math.max(0,_-e)),setTimeout(t,i)};i.removeApp=function(t){var e=!1,i=this.stage;return this._app&&(this.contains(this._app)&&this.removeChild(this._app),i.removeAllChildren(),this._app.destroy(),e=!0),this._app=null,this.pause(),t||(i.addChild(this),a&&(a.text="FPS: 0.000"),r=o=l=h=0,this.stage.update()),e},i.addApp=function(t){if(this.removeApp(),!(t instanceof cloudkid.Application))throw new Error("Can only objects that inherit cloudkid.Application");this._app=t,n&&(this.addChildAt(t,0),this._app.init(),this.resume())},i.getApp=function(){return this._app},i.addUpdateCallback=function(e,i){this._updateFunctions[e]===t&&(this._updateFunctions[e]=i)},i.removeUpdateCallback=function(e){this._updateFunctions[e]!==t&&delete this._updateFunctions[e]},i.tick=function(){if(s)return void(c=-1);var t=this.getTime(),e=t-r;if(a&&a.visible){h++;var i=t-o;i>1e3&&(l=1e3/i*h,a.text="FPS: "+Math.round(1e3*l)/1e3,o=t,h=0)}r=t,this._app&&this._app.update(e);for(var n in this._updateFunctions)this._updateFunctions[n](e);this.stage.update(e),c=g?requestAnimFrame(u):C(u,this.getTime()-r)},i.destroy=function(){var t=this.stage,e=cloudkid.MediaLoader.instance;this.pause(),this.removeApp(!0),d=null,createjs.Touch.disable(t),t.enableMouseOver(-1),t.enableDOMEvents(!1),e.destroy(),this.stage=null,this._updateFunctions=null,y(this.visibleListener)},Object.defineProperty(e,"instance",{get:function(){if(!d)throw"Call cloudkid.OS.init(canvasId)";return d}}),namespace("cloudkid").OS=e}(),function(t){"use strict";var e={};Function.prototype.bind||(e.bind=Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=Array.prototype.slice.call(arguments,1),s=function(){if(this instanceof s){var n=function(){};n.prototype=e.prototype;var a=new n,r=e.apply(a,i.concat(Array.prototype.slice.call(arguments)));return Object(r)===r?r:a}return e.apply(t,i.concat(Array.prototype.slice.call(arguments)))};return s});for(var i=0,s=["ms","moz","webkit","o"],n=0;n<s.length&&!t.requestAnimationFrame;++n)t.requestAnimationFrame=t[s[n]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[s[n]+"CancelAnimationFrame"]||t[s[n]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(e){var s=(new Date).getTime(),n=Math.max(0,16-(s-i)),a=t.setTimeout(function(){e(s+n)},n);return i=s+n,a},t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})),e.requestAnimationFrame=t.requestAnimationFrame,t.requestAnimFrame=t.requestAnimationFrame,e.cancelAnimationFrame=t.cancelAnimationFrame,namespace("cloudkid").FunctionUtils=e}(window),function(){"use strict";var t={};t.loadSpriteSheet=function(t,e,i){i>0||(i=1);for(var s in t){var n=t[s],a=s.indexOf(".");a>0&&(s=s.substring(0,a));var r=lib[s],o=lib[s]=function(){createjs.Container.call(this);var t=new createjs.Bitmap(this._image);this.addChild(t),t.sourceRect=this._frameRect;var e=this._scale;t.setTransform(this._frameOffsetX*e,this._frameOffsetY*e,e,e)},l=o.prototype=new createjs.Container;l._image=e,l._scale=i;var h=n.frame;l._frameRect=new createjs.Rectangle(h.x,h.y,h.w,h.h),n.trimmed?(l._frameOffsetX=n.spriteSourceSize.x,l._frameOffsetY=n.spriteSourceSize.y):l._frameOffsetX=l._frameOffsetY=0,l.nominalBounds=r&&r.prototype.nominalBounds?r.prototype.nominalBounds:new createjs.Rectangle(0,0,n.sourceSize.w,n.sourceSize.h)}},t.replaceWithScaledBitmap=function(t,e){if(1!=e&&e>0){var i,s,n,a;if("string"==typeof t)i=t,s=lib[i],s&&(n=lib[i]=function(){createjs.Container.call(this);var t=new this._oldBM;this.addChild(t),t.setTransform(0,0,this._scale,this._scale)},a=n.prototype=new createjs.Container,a._oldBM=s,a._scale=e,a.nominalBounds=s.prototype.nominalBounds);else for(i in t)s=lib[i],s&&(n=lib[i]=function(){createjs.Container.call(this);var t=new this._oldBM;this.addChild(t),t.setTransform(0,0,this._scale,this._scale)},a=n.prototype=new createjs.Container,a._oldBM=s,a._scale=e,a.nominalBounds=s.prototype.nominalBounds)}},namespace("cloudkid").BitmapUtils=t}(),function(){"use strict";var t={},e="undefined"!=typeof window.Storage,i=-1;if(e)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST")}catch(s){e=!1}t.remove=function(s){e?(localStorage.removeItem(s),sessionStorage.removeItem(s)):t.write(s,"",i)},t.write=function(t,s,n){if(e)n?sessionStorage.setItem(t,JSON.stringify(s)):localStorage.setItem(t,JSON.stringify(s));else{var a;a=n?n!==i?"":"; expires=Thu, 01 Jan 1970 00:00:00 GMT":"; expires="+new Date(2147483646e3).toGMTString(),document.cookie=t+"="+escape(JSON.stringify(s))+a+"; path=/"}},t.read=function(t){if(e){var i=localStorage.getItem(t)||sessionStorage.getItem(t);return i?JSON.parse(i):null}var s,n=t+"=",a=document.cookie.split(";"),r=0;for(r=0;r<a.length;r++){for(s=a[r];" "==s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(n))return JSON.parse(unescape(s.substring(n.length,s.length)))}return null},namespace("cloudkid").SavedData=t}(),function(){"use strict";window.URL=window.URL||window.webkitURL,window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;var Worker={};Worker.init=function(t){if(!window.URL||!window.Worker)return new FallbackWorker(t);var e;try{e=new Blob([t],{type:"application/javascript"})}catch(i){if(!window.BlobBuilder)return new FallbackWorker(t);try{e=new BlobBuilder,e.append(t),e=e.getBlob()}catch(s){return new FallbackWorker(t)}}if(!e)return new FallbackWorker(t);try{var n=new Worker(URL.createObjectURL(e));return n}catch(i){return new FallbackWorker(t)}},namespace("cloudkid").createWorker=Worker.init,namespace("cloudkid").Worker=Worker;var SubWorker=function(codeString,parent){this._wParent=parent,eval(codeString)},p=SubWorker.prototype;p.onmessage=null,p._wParent=null,p.postMessage=function(t){var e=this._wParent;setTimeout(e.onmessage.bind(e,{data:t}),1)};var FallbackWorker=function(t){this._wChild=new SubWorker(t,this)};p=FallbackWorker.prototype,p.postMessage=function(t){var e=this._wChild;setTimeout(e.onmessage.bind(e,{data:t}),1)},p.terminate=function(){this.onmessage=null;var t=this._wChild;t._wParent=null,t.onmessage=null,this._wChild=null},p.onmessage=null,p._wChild=null}(),function(){"use strict";var t=function(t,e,i,s){e[i]?e[s]=t:t()};t.create=function(e,i,s,n){return t.bind(this,e,i,s,n)},namespace("cloudkid").CombinedCallback=t}(),function(t){"use strict";var e=0,i=function(i,s,n,a){this._callback=i,this._delay=s,this._timer=s,this._repeat=!!n,this._autoDestroy=a===t?!0:!!a,this._updateId="DelayedCall#"+ ++e,this._paused=!1,this._update=this._update.bind(this),cloudkid.OS.instance.addUpdateCallback(this._updateId,this._update)},s=i.prototype;s._update=function(t){return this._callback?(this._timer-=t,void(this._timer<=0&&(this._callback(),this._repeat?this._timer+=this._delay:this._autoDestroy?this.destroy():cloudkid.OS.instance.removeUpdateCallback(this._updateId)))):void this.destroy()},s.restart=function(){if(this._callback){var t=cloudkid.OS.instance;t.hasUpdateCallback(this._updateId)||t.addUpdateCallback(this._updateId,this._update),this._timer=this._delay,this._paused=!1}},s.stop=function(){cloudkid.OS.instance.removeUpdateCallback(this._updateId),this._paused=!1},Object.defineProperty(s,"paused",{get:function(){return this._paused},set:function(t){if(this._callback){var e=cloudkid.OS.instance;this._paused&&!t?(this._paused=!1,e.hasUpdateCallback(this._updateId)||e.addUpdateCallback(this._updateId,this._update)):t&&e.hasUpdateCallback(this._updateId)&&(this._paused=!0,e.removeUpdateCallback(this._updateId))}}}),s.destroy=function(){cloudkid.OS.instance.removeUpdateCallback(this._updateId),this._callback=null},namespace("cloudkid").DelayedCall=i}(),function(){"use strict";var t,e=function(){this.initialize()};t=e.prototype=new createjs.Container,t.init=function(){},t.update=function(){},t.destroy=function(){},t.resize=function(){},namespace("cloudkid").Application=e}(),function(){"use strict";var t=function(){},e=t.prototype;t.PRIORITY_HIGH=1,t.PRIORITY_NORMAL=0,t.PRIORITY_LOW=-1,e.url=null,e.data=null,e.callback=null,e.priority=0,e.progress=0,e.updateCallback=null,e._boundFail=null,e._boundProgress=null,e._boundComplete=null,e.toString=function(){return"[LoaderQueueItem(url:'"+this.url+"', priority:"+this.priority+")]"},e.destroy=function(){this.callback=null,this.updateCallback=null,this.data=null,this._boundFail=null,this._boundProgress=null,this._boundComplete=null},namespace("cloudkid").LoaderQueueItem=t}(),function(){"use strict";var t=function(){},e=t.prototype;t._instance=null;var s=null,n=null,a=null,r=null,o=null,l=null,h=0,u=null;e._canLoad=!0,e.maxSimultaneousLoads=2,e.cacheManager=null,t.init=function(){return t._instance||(t._instance=new t,t._instance._initialize()),t._instance},Object.defineProperty(t,"instance",{get:function(){if(!t._instance)throw"Call cloudkid.MediaLoader.init()";return t._instance}}),e.destroy=function(){var e,i,h,d=this.queue;if(d){for(e=0,i=d.length;e>e;++e)d[e].destroy();for(d=r,e=0,i=d.length;e>e;++e)d[e].destroy();for(d=l,e=0,i=d.length;e>e;++e)d[e].destroy();for(h in a)n[h].destroy(),a[h].close()}t._instance=null,this.cacheManager&&this.cacheManager.destroy(),this.cacheManager=null,s=null,l=null,o=null,r=null,n=null,u=null,a=null},e._initialize=function(){r=[],o=[],l=[],s=[],n={},a={},u={},this.cacheManager=new cloudkid.CacheManager},e.load=function(t,e,i,n,a){var r=this._getQI(),o=cloudkid.OS.instance.options.basePath;void 0!==o&&/^http(s)?\:/.test(t)===!1&&-1==t.search(o)&&(r.basePath=o),r.url=t,r.callback=e,r.updateCallback=i||null,r.priority=n||cloudkid.LoaderQueueItem.PRIORITY_NORMAL,r.data=a||null,s.push(r),s.sort(function(t,e){return t.priority-e.priority}),this._tryNextLoad()},e._onLoadFailed=function(t,e){Debug.error("Unable to load file: "+t.url+" - reason: "+e.error);var i=a[t.url];i.removeAllEventListeners(),i.close(),this._poolLoader(i),delete n[t.url],delete a[t.url],u[t.url]?u[t.url]++:u[t.url]=1,u[t.url]>3?this._loadDone(t,null):(h--,s.push(t),this._tryNextLoad())},e._onLoadProgress=function(t,e){t.progress=e.progress,t.updateCallback&&t.updateCallback(t.progress)},e._onLoadCompleted=function(t,e){var i=a[t.url];i.removeAllEventListeners(),i.close(),this._poolLoader(i),delete n[t.url],delete a[t.url],this._loadDone(t,this._getResult(e.result,t.url,i))},e._tryNextLoad=function(){if(!(h>this.maxSimultaneousLoads-1||0===s.length)){h++;var t=s.shift();n[t.url]=t;var e=this._getLoader(t.basePath);a[t.url]=e,e.addEventListener("fileload",t._boundComplete),e.addEventListener("error",t._boundFail),e.addEventListener("fileprogress",t._boundProgress);var i=this.cacheManager.prepare(t.url);e.loadFile(t.data?{id:t.data.id,src:i,data:t.data}:i)}},e._loadDone=function(t,e){h--,t.data&&e&&(e.id=t.data.id),t.callback(e),this._poolQI(t),this._tryNextLoad()},e.cancel=function(t){var e=n[t],r=a[t];if(e&&r)return r.close(),delete a[t],delete n[e.url],h--,this._poolLoader(r),this._poolQI(e),!0;for(i=0,len=s.length;len>i;i++)if(e=s[i],e.url==t)return s.splice(i,1),this._poolQI(e),!0;return!1},e._getQI=function(){var t;return r.length?t=r.pop():(t=new cloudkid.LoaderQueueItem,t._boundFail=this._onLoadFailed.bind(this,t),t._boundProgress=this._onLoadProgress.bind(this,t),t._boundComplete=this._onLoadCompleted.bind(this,t)),t},e._poolQI=function(t){r.push(t),t.callback=t.updateCallback=t.data=t.url=null,t.progress=0},e._getLoader=function(t){var e;return o.length?(e=o.pop(),e._basePath=t):e=new createjs.LoadQueue(!0,t),createjs.Sound&&e.installPlugin(createjs.Sound),e},e._poolLoader=function(t){t.removeAll(),o.push(t)},e._getResult=function(t,e,i){var s;return l.length?(s=l.pop(),s.content=t,s.url=e,s.loader=i):s=new cloudkid.MediaLoaderResult(t,e,i),s},e._poolResult=function(t){t.content=t.url=t.loader=t.id=null,l.push(t)},namespace("cloudkid").MediaLoader=t}(),function(){"use strict";var t=function(t,e,i){this.content=t,this.url=e,this.loader=i},e=t.prototype;e.content=null,e.url=null,e.loader=null,e.toString=function(){return"[MediaLoaderResult('"+this.url+"')]"},e.destroy=function(){this.callback=null,this.url=null,this.content=null},namespace("cloudkid").MediaLoaderResult=t}(),function(t){"use strict";var e=function(){this.initialize()},i=e.prototype={};i._versions=null,i.cacheBust=!1,i.initialize=function(){this._versions=[];var t=cloudkid.OS.instance.options.cacheBust;this.cacheBust=t?"true"===t||t===!0:!1},i.destroy=function(){this._versions=null},i.addVersionsFile=function(t,e,i){Debug.assert(/^.*\.txt$/.test(t),"The versions file must be a *.txt file");var s=cloudkid.MediaLoader.instance;if(this.cacheBust)return void(e&&e());this.addVersion(t,Math.round(1e5*Math.random()));var n=this;s.load(t,function(t){if(t&&t.content){var s,a,r=t.content.replace(/\r/g,"").split("\n");for(s=0;s<r.length;s++)r[s]&&(a=r[s].split(" "),2==a.length&&n.addVersion((i||"")+a[0],a[1]))}e&&e()})},i.addVersion=function(t,e){var i=this._getVersionByUrl(t);i||this._versions.push({url:t,version:e})},i._getVersionByUrl=function(t){var e,i=this._versions.length;for(e=0;i>e;e++)if(t==this._versions[e].url)return this._versions[e];return null},i.prepare=function(e,i){var s=this._getVersionByUrl(e);if(this.cacheBust&&/(\?|\&)cb\=[0-9]*/.test(e)===!1?(this._cbVal||(this._cbVal=(new Date).getTime().toString()),e=e+(e.indexOf("?")<0?"?":"&")+"cb="+this._cbVal):s&&/(\?|\&)v\=[0-9]*/.test(e)===!1&&(e=e+(e.indexOf("?")<0?"?":"&")+"v="+s.version),i){var n=cloudkid.OS.instance.options.basePath;/^http(s)?\:/.test(e)===!1&&n!==t&&-1==e.search(n)&&(e=n+e)}return e},namespace("cloudkid").CacheManager=e}(),function(t){"use strict";function e(t){if(!t||"object"!=typeof t)return null;var e=t.constructor();for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}var i=function(t,e,i){t&&this.initialize(t,e,i)},s=i.prototype=new createjs.Container,n=createjs.Container.prototype;s.back=null,s.label=null,s._overCB=null,s._outCB=null,s._downCB=null,s._upCB=null,s._clickCB=null,s._stateFlags=null,s._statePriority=null,s._stateData=null,s._width=0,s._height=0,s._offset=null,i.BUTTON_PRESS="buttonPress";var a=["disabled","enabled","up","over","down"],r=["disabled","down","over","up"];s.initialize=function(i,s,a){n.initialize.call(this),this.mouseChildren=!1,this._downCB=this._onMouseDown.bind(this),this._upCB=this._onMouseUp.bind(this),this._overCB=this._onMouseOver.bind(this),this._outCB=this._onMouseOut.bind(this),this._clickCB=this._onClick.bind(this);var o=this._stateData={};this._stateFlags={},this._offset=new createjs.Point;var l;s&&(l=e(s),delete l.text,l.x===t&&(l.x="center"),l.y===t&&(l.y="center"));var h,u,d,c,g;if(i.image){for(h=i.image,this._statePriority=i.priority||r,c=this._statePriority.length-1;c>=0;--c){g=this._statePriority[c],this._addProperty(g),"disabled"!=g&&"up"!=g&&(this._stateFlags[g]=!1);var p=i[g];if(o[g]=p?e(p):o.up,s)if(p&&p.label){p=p.label;var _=o[g].label={};_.font=p.font||l.font,_.color=p.color||l.color,_.stroke=p.hasOwnProperty("stroke")?p.stroke:l.stroke,_.shadow=p.hasOwnProperty("shadow")?p.shadow:l.shadow,_.textBaseline=p.textBaseline||l.textBaseline,_.x=p.x||l.x,_.y=p.y||l.y}else o[g].label=l}if(o.up.trim){var f=o.up.trim;u=f.width,d=f.height}else u=o.up.src.width,d=o.up.src.height;o.up||(Debug.error("Button lacks an up state! This is a serious problem! Input data follows:"),Debug.error(i)),o.over||(o.over=o.up),o.down||(o.down=o.up),o.disabled||(o.disabled=o.up),i.offset?(this._offset.x=i.offset.x,this._offset.y=i.offset.y):this._offset.x=this._offset.y=0}else h=i,u=h.width,d=h.height/3,this._statePriority=r,o.disabled=o.up={src:new createjs.Rectangle(0,0,u,d)},o.over={src:new createjs.Rectangle(0,d,u,d)},o.down={src:new createjs.Rectangle(0,2*d,u,d)},l&&(o.up.label=o.over.label=o.down.label=o.disabled.label=l),this._offset.x=this._offset.y=0;this.back=new createjs.Bitmap(h),this.addChild(this.back),this._width=u,this._height=d,s&&(this.label=new createjs.Text(s.text||"",o.up.label.font,o.up.label.color),this.addChild(this.label)),this.enabled=a===t?!0:!!a},Object.defineProperty(s,"width",{get:function(){return this._width*this.scaleX},set:function(t){this.scaleX=t/this._width}}),Object.defineProperty(s,"height",{get:function(){return this._height*this.scaleY},set:function(t){this.scaleY=t/this._height}}),s.setText=function(t){if(this.label){this.label.text=t;for(var e,i=0;i<this._statePriority.length;++i)if(this._stateFlags[this._statePriority[i]]){e=this._stateData[this._statePriority[i]];break}e||(e=this._stateData.up),e=e.label,this.label.x="center"==e.x?.5*(this._width-this.label.getMeasuredWidth())+this._offset.x:e.x+this._offset.x,this.label.y="center"==e.y?.5*this._height+this._offset.y:e.y+this._offset.y}},Object.defineProperty(s,"enabled",{get:function(){return!this._stateFlags.disabled},set:function(t){this._stateFlags.disabled=!t,t?(this.cursor="pointer",this.addEventListener("mousedown",this._downCB),this.addEventListener("mouseover",this._overCB),this.addEventListener("mouseout",this._outCB)):(this.cursor=null,this.removeEventListener("mousedown",this._downCB),this.removeEventListener("mouseover",this._overCB),this.removeEventListener("mouseout",this._outCB),this.removeEventListener("pressup",this._upCB),this.removeEventListener("click",this._clickCB),this._stateFlags.down=this._stateFlags.over=!1),this._updateState()}}),s._addProperty=function(t){a.indexOf(t)>=0||Object.defineProperty(this,t,{get:function(){return this._stateFlags[t]},set:function(e){this._stateFlags[t]=e,this._updateState()}})},s._updateState=function(){if(this.back){for(var t,e=0;e<this._statePriority.length;++e)if(this._stateFlags[this._statePriority[e]]){t=this._stateData[this._statePriority[e]];break}t||(t=this._stateData.up),this.back.sourceRect=t.src,t.trim?(this.back.x=t.trim.x+this._offset.x,this.back.y=t.trim.y+this._offset.y):(this.back.x=this._offset.x,this.back.y=this._offset.y),this.label&&(t=t.label,this.label.textBaseline=t.textBaseline||"middle",this.label.stroke=t.stroke,this.label.shadow=t.shadow,this.label.font=t.font,this.label.color=t.color||"#000",this.label.x="center"==t.x?.5*(this._width-this.label.getMeasuredWidth())+this._offset.x:t.x+this._offset.x,this.label.y="center"==t.y?.5*this._height+this._offset.y:t.y+this._offset.y)}},s._onMouseDown=function(){this.addEventListener("pressup",this._upCB),this.addEventListener("click",this._clickCB),this._stateFlags.down=!0,this._updateState()},s._onMouseUp=function(){this.removeEventListener("pressup",this._upCB),this.removeEventListener("click",this._clickCB),this._stateFlags.down=!1,this._updateState()},s._onClick=function(){this.dispatchEvent(new createjs.Event(i.BUTTON_PRESS))},s._onMouseOver=function(){this._stateFlags.over=!0,this._updateState()},s._onMouseOut=function(){this._stateFlags.over=!1,this._updateState()},s.destroy=function(){this.removeAllChildren(),this.removeAllEventListeners(),this._downCB=null,this._upCB=null,this._overCB=null,this._outCB=null,this.back=null,this.label=null,this._statePriority=null,this._stateFlags=null,this._stateData=null},i.generateDefaultStates=function(e,i,s){var n=e.width,a=e.height/3,o=document.createElement("canvas"),l=n,h=e.height;i&&(h+=a),s&&(l+=2*s.size,h+=a+2*s.size),o.width=l,o.height=h;var u=o.getContext("2d");u.drawImage(e,0,0);var d={image:o,up:{src:new createjs.Rectangle(0,0,n,a)},over:{src:new createjs.Rectangle(0,a,n,a)},down:{src:new createjs.Rectangle(0,2*a,n,a)}},c=new createjs.Bitmap(e);c.sourceRect=d.up.src;var g=e.height;if(i){u.save(),u.translate(0,g);var p=new createjs.ColorMatrix;i.saturation!==t&&p.adjustSaturation(i.saturation),i.brightness!==t&&p.adjustBrightness(2.55*i.brightness),i.contrast!==t&&p.adjustContrast(i.contrast),c.filters=[new createjs.ColorMatrixFilter(p)],c.cache(0,0,d.up.src.width,d.up.src.height),c.draw(u),d.disabled={src:new createjs.Rectangle(0,g,n,a)},g+=a,u.restore()}if(s){u.save();var _=n+2*s.size,f=a+2*s.size;c.filters=[new createjs.ColorFilter(0,0,0,1,s.red,s.green,s.blue,s.alpha!==t?-255+s.alpha:0)],c.scaleX=_/n,c.scaleY=f/a,c.x=0,c.y=g,c.cache(0,0,_,f),c.updateContext(u),c.draw(u),u.restore(),c.scaleX=c.scaleY=1,c.x=s.size,c.y=g+s.size,c.filters=null,c.uncache(),c.updateContext(u),c.draw(u);var m=new createjs.Rectangle(s.size,s.size,_,f);d.up.trim=m,d.over.trim=m,d.down.trim=m,d.disabled&&(d.disabled.trim=m),d.highlighted={src:new createjs.Rectangle(0,g,_,f)},d.priority=r.slice(),d.priority.unshift("highlighted"),d.offset={x:-s.size,y:-s.size}}return d},namespace("cloudkid").Button=i}(),function(){"use strict";var t=function(t,e){this.initialize(t,e)},e=t.prototype={};e.draggedObj=null,e.dragStartThreshold=20,e.mouseDownStagePos=null,e.mouseDownObjPos=null,e.allowStickyClick=!0,e.isTouchMove=!1,e.isHeldDrag=!1,e.isStickyClick=!1,e.snapSettings=null,e._theStage=null,e._dragOffset=null,e._dragStartCallback=null,e._dragEndCallback=null,e._triggerHeldDragCallback=null,e._triggerStickyClickCallback=null,e._stageMouseUpCallback=null,e._draggableObjects=null,e._updateCallback=null,e._helperPoint=null,e.initialize=function(t,e){this._updateCallback=this._updateObjPosition.bind(this),this._triggerHeldDragCallback=this._triggerHeldDrag.bind(this),this._triggerStickyClickCallback=this._triggerStickyClick.bind(this),this._stageMouseUpCallback=this._stopDrag.bind(this),this._theStage=cloudkid.OS.instance.stage,this._dragStartCallback=t,this._dragEndCallback=e,this._draggableObjects=[],this.mouseDownStagePos={x:0,y:0},this.mouseDownObjPos={x:0,y:0}},e.startDrag=function(t,e){this._objMouseDown(e,t)},e._objMouseDown=function(t,e){null===this.draggedObj&&(this.draggedObj=e,createjs.Tween.removeTweens(e),this._dragOffset=this.draggedObj.parent.globalToLocal(t?t.stageX:0,t?t.stageY:0),this._dragOffset.x-=e.x,this._dragOffset.y-=e.y,this.mouseDownObjPos.x=e.x,this.mouseDownObjPos.y=e.y,t?(this._theStage._getPointerData(t.pointerID).target=e,this.allowStickyClick&&"touchstart"!=t.nativeEvent.type?(this.mouseDownStagePos.x=t.stageX,this.mouseDownStagePos.y=t.stageY,e.addEventListener("pressmove",this._triggerHeldDragCallback),e.addEventListener("pressup",this._triggerStickyClickCallback)):(this.mouseDownStagePos.x=t.stageX,this.mouseDownStagePos.y=t.stageY,this.isTouchMove="touchstart"==t.nativeEvent.type,this.isHeldDrag=!0,this._startDrag())):(this.isHeldDrag=!0,this._startDrag()))},e._triggerStickyClick=function(){this.isStickyClick=!0,this.draggedObj.removeEventListener("pressmove",this._triggerHeldDragCallback),this.draggedObj.removeEventListener("pressup",this._triggerStickyClickCallback),this._startDrag()},e._triggerHeldDrag=function(t){var e=t.stageX-this.mouseDownStagePos.x,i=t.stageY-this.mouseDownStagePos.y;e*e+i*i>=this.dragStartThreshold*this.dragStartThreshold&&(this.isHeldDrag=!0,this.draggedObj.removeEventListener("pressmove",this._triggerHeldDragCallback),this.draggedObj.removeEventListener("pressup",this._triggerStickyClickCallback),this._startDrag())},e._startDrag=function(){var t=this._theStage;t.removeEventListener("stagemousemove",this._updateCallback),t.addEventListener("stagemousemove",this._updateCallback),t.removeEventListener("stagemouseup",this._stageMouseUpCallback),t.addEventListener("stagemouseup",this._stageMouseUpCallback),this._dragStartCallback(this.draggedObj)},e.stopDrag=function(t){this._stopDrag(null,t===!0)},e._stopDrag=function(t,e){var i=this.draggedObj;i.removeEventListener("pressmove",this._triggerHeldDragCallback),i.removeEventListener("pressup",this._triggerStickyClickCallback),this._theStage.removeEventListener("stagemousemove",this._updateCallback),this._theStage.removeEventListener("stagemouseup",this._stageMouseUpCallback),this.draggedObj=null,this.isTouchMove=!1,this.isStickyClick=!1,this.isHeldMove=!1,e!==!1&&this._dragEndCallback(i)},e._updateObjPosition=function(t){if(this.isTouchMove||this._theStage.mouseInBounds){var e=this.draggedObj,i=e.parent.globalToLocal(t.stageX,t.stageY,this._helperPoint),n=e._dragBounds;if(e.x=s(i.x-this._dragOffset.x,n.x,n.right),e.y=s(i.y-this._dragOffset.y,n.y,n.bottom),this.snapSettings)switch(this.snapSettings.mode){case"points":this._handlePointSnap(i);break;case"grid":break;case"line":}}},e._handlePointSnap=function(t){for(var e=this.snapSettings,s=e.dist*e.dist,n=e.points,a=t.x-this._dragOffset.x,r=t.y-this._dragOffset.y,o=-1,l=null,h=n.length-1;h>=0;--h){var u=n[h],d=i(a,r,u.x,u.y);s>=d&&(o>d||-1==o)&&(o=d,l=u)}l&&(this.draggedObj.x=l.x,this.draggedObj.y=l.y)};var i=function(t,e,i,s){var n=t-i,a=e-s;return n*n+a*a},s=function(t,e,i){return e>t?e:t>i?i:t},n=function(){this.addEventListener("mousedown",this._onMouseDownListener),this.cursor="pointer"},a=function(){this.removeEventListener("mousedown",this._onMouseDownListener),this.cursor=null},r=function(t){this._dragMan._objMouseDown(t,this)};e.addObject=function(t,e){e||(e={x:0,y:0,width:this._theStage.canvas.width,height:this._theStage.canvas.height}),e.right=e.x+e.width,e.bottom=e.y+e.height,t._dragBounds=e,this._draggableObjects.indexOf(t)>=0||(t.enableDrag=n,t.disableDrag=a,t._onMouseDownListener=r.bind(t),t._dragMan=this,this._draggableObjects.push(t))},e.removeObject=function(t){t.disableDrag(),delete t.enableDrag,delete t.disableDrag,delete t._onMouseDownListener,delete t._dragMan,delete t._dragBounds;var e=this._draggableObjects.indexOf(t);e>=0&&this._draggableObjects.splice(e,1)},e.destroy=function(){null!==this.draggedObj&&(this.draggedObj.removeEventListener("pressmove",this._triggerHeldDragCallback),this.draggedObj.removeEventListener("pressup",this._triggerStickyClickCallback),this._theStage.removeEventListener("stagemousemove",this._updateCallback),this.draggedObj=null),this._updateCallback=null,this._dragStartCallback=null,this._dragEndCallback=null,this._triggerHeldDragCallback=null,this._triggerStickyClickCallback=null,this._stageMouseUpCallback=null,this._theStage=null;for(var t=this._draggableObjects.length-1;t>=0;--t){var e=this._draggableObjects[t];e.disableDrag(),delete e.enableDrag,delete e.disableDrag,delete e._onMouseDownListener,delete e._dragMan,delete e._dragBounds}this._draggableObjects=null,this._helperPoint=null},namespace("cloudkid").DragManager=t}(),function(){"use strict";var t=function(){};t.prototype={},t.positionItems=function(e,i){var s,n;for(var a in i){var r=e[a];if(r){var o=i[a];if(r.x=o.x,r.y=o.y,n=o.scale,n&&(r.scaleX*=n.x,r.scaleY*=n.y),n=o.pivot,n&&(r.regX=n.x,r.regY=n.y),s=o.rotation,s&&(r.rotation=s),o.hitArea){var l=o.hitArea;r.hitShape=t.generateHitArea(l)}}else Debug.error("could not find object '"+a+"'")}},t.generateHitArea=function(t,i){i||(i=1);var s;if(s=window.createjs,e(t)){if(1==i)return new s.Polygon(t);for(var n=[],a=0,r=t.length;r>a;++a)n.push(new s.Point(t[a].x*i,t[a].y*i));return new s.Polygon(n)}return"rect"!=t.type&&t.type?"ellipse"==t.type?new s.Ellipse((t.x-.5*t.w)*i,(t.y-.5*t.h)*i,t.w*i,t.h*i):"circle"==t.type?new s.Circle(t.x*i,t.y*i,t.r*i):"sector"==t.type?new s.Sector(t.x*i,t.y*i,t.r*i,t.start,t.end):null:new s.Rectangle(t.x*i,t.y*i,t.w*i,t.h*i)};var e=function(t){return"[object Array]"===Object.prototype.toString.call(t)};namespace("cloudkid").Positioner=t}(),function(){"use strict";var t=function(t,e,i){this.width=t,this.height=e,this.ppi=i};t.prototype={},namespace("cloudkid").ScreenSettings=t}(),function(){"use strict";var t,e=function(e,i,s){switch(t=cloudkid.UIScaler,this._item=e,this._settings=i,this._designedScreen=s,this.origScaleX=e.scaleX,this.origScaleY=e.scaleY,this.origWidth=e.width,this.origBounds={x:0,y:0,width:e.width,height:e.height},this.origBounds.right=this.origBounds.x+this.origBounds.width,this.origBounds.bottom=this.origBounds.y+this.origBounds.height,i.vertAlign){case t.ALIGN_TOP:this.origMarginVert=e.y+this.origBounds.y;break;case t.ALIGN_CENTER:this.origMarginVert=.5*s.height-e.y;break;case t.ALIGN_BOTTOM:this.origMarginVert=s.height-(e.y+this.origBounds.bottom)}switch(i.horiAlign){case t.ALIGN_LEFT:this.origMarginHori=e.x+this.origBounds.x;break;case t.ALIGN_CENTER:this.origMarginHori=.5*s.width-e.x;break;case t.ALIGN_RIGHT:this.origMarginHori=s.width-(e.x+this.origBounds.right)}},i=e.prototype={};i.origMarginHori=0,i.origMarginVert=0,i.origWidth=0,i.origScaleX=0,i.origScaleY=0,i.origBounds=null,i._settings=null,i._item=null,i._designedScreen=null,i.resize=function(e){var i=e.height/this._designedScreen.height,s=e.ppi/this._designedScreen.ppi,n=(e.width-this._designedScreen.width*i)/2,a=i/s;
this._settings.minScale&&a<this._settings.minScale?a=this._settings.minScale:this._settings.maxScale&&a>this._settings.maxScale&&(a=this._settings.maxScale),a*=s,this._item.scaleX=this.origScaleX*a,this._item.scaleY=this.origScaleY*a;var r;switch(r=this.origMarginVert*i,this._settings.vertAlign){case t.ALIGN_TOP:this._item.y=r-this.origBounds.y*a;break;case t.ALIGN_CENTER:this._item.y=.5*e.height-r;break;case t.ALIGN_BOTTOM:this._item.y=e.height-r-this.origBounds.bottom*a}switch(r=this.origMarginHori*i,this._settings.horiAlign){case t.ALIGN_LEFT:this._item.x=this._settings.titleSafe?n+r-this.origBounds.x*a:r-this.origBounds.x*a;break;case t.ALIGN_CENTER:this._item.x=this._settings.centeredHorizontally?.5*(e.width-this._item.width):.5*e.width-r;break;case t.ALIGN_RIGHT:this._item.x=this._settings.titleSafe?e.width-n-r-this.origBounds.right*a:e.width-r-this.origBounds.right*a}},i.destroy=function(){this.origBounds=null,this._item=null,this._settings=null,this._designedScreen=null},namespace("cloudkid").UIElement=e}(),function(){"use strict";var t=function(){},e=t.prototype={};e.vertAlign=null,e.horiAlign=null,e.titleSafe=!1,e.maxScale=1,e.minScale=1,e.centeredHorizontally=!1,namespace("cloudkid").UIElementSettings=t}(),function(){"use strict";var t=cloudkid.UIElementSettings,e=cloudkid.UIElement,i=cloudkid.ScreenSettings,s=function(t,e,s,n){this._parent=t,this._items=[],this._designedScreen=new i(e,s,n)},n=s.prototype={},a=new i(0,0,0),r=!1;n._parent=null,n._designedScreen=null,n._items=null,s.ALIGN_TOP="top",s.ALIGN_BOTTOM="bottom",s.ALIGN_LEFT="left",s.ALIGN_RIGHT="right",s.ALIGN_CENTER="center",s.fromJSON=function(t,e,i,n){"boolean"!=typeof n&&(n=!0);var a,r,o,l,h,u=new s(t,e.designedWidth,e.designedHeight,e.designedPPI);for(r in i)a=i[r],a.align?(o=a.align.split("-"),l=o[0],h=o[1]):(l=ALIGN_CENTER,h=ALIGN_CENTER),u.add(t[r],l,h,a.titleSafe||!1,a.minScale||0/0,a.maxScale||0/0,a.centeredHorizontally||!1);return u.resize(),n&&u.destroy(),u},s.init=function(t,e,i){a.width=t,a.height=e,a.ppi=i,r=!0},n.getScale=function(){return a.height/this._designedScreen.height},n.add=function(i,n,a,r,o,l,h){var u=new t;u.vertAlign=n||s.ALIGN_CENTER,u.horiAlign=a||s.ALIGN_CENTER,u.titleSafe="boolean"!=typeof r?!1:r,u.maxScale="number"!=typeof l?0/0:l,u.minScale="number"!=typeof o?0/0:o,u.centeredHorizontally=h||!1,this._items.push(new e(i,u,this._designedScreen))},s.resizeBackground=function(t){if(r){var e,i,s;e=t.image.height,i=t.image.width,s=a.height/e,t.scaleX=t.scaleY=s,t.x=.5*(a.width-i*s)}},s.resizeBackgrounds=function(t){for(var e=0,i=t.length;i>e;++e)s.resizeBackground(t[e])},n.resize=function(){if(this._items.length>0)for(var t=0,e=this._items.length;e>t;++t)this._items[t].resize(a)},n.destroy=function(){if(this._items.length>0)for(var t=0,e=this._items.length;e>t;++t)this._items[t].destroy();this._parent=null,this._designedScreen=null,this._items=null},namespace("cloudkid").UIScaler=s}();