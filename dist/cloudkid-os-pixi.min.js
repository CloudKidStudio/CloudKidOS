!function(t){var e=function(){},i=e.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),n=!1,s=!1,a=null,o=0,r=0,l=null,u=0,h=null,d=null,c=-1,g=!1,p=0,_=0;e.VERSION="1.1.25",i.stage=null,i._renderer=null,i.canvasContainer=null,i._app=null,i.options=null,i._updateFunctions={},e.init=function(t,i){return d||(d=new e,d.initialize(t,i)),d},i.initialize=function(e,i){PIXI.DisplayObjectContainer.call(this),this.options=i||{},this.options.parseQueryString!==t&&(this.options=k(this.options)),this.options.debug!==t&&(Debug.enabled=this.options.debug===!0||"true"===this.options.debug),this.options.minLogLevel!==t&&(Debug.minLogLevel=parseInt(this.options.minLogLevel,10)),"string"==typeof this.options.ip&&Debug.connect(this.options.ip);var n=cloudkid.MediaLoader.init();this.stage=new PIXI.Stage(this.options.backgroundColor||0,!0),this.stage.addChild(this),this.visibleListener=this.onWindowVisibilityChanged.bind(this),y(this.visibleListener);var o=!!this.options.transparent||!1,r=!!this.options.preMultAlpha||!1;this.containerName="string"==typeof e?e:e.attr("id");var l="string"==typeof e?document.getElementById(e):e,u=this.canvasContainer=document.createElement("div");l.appendChild(u),u.id="CKOS";var d=this.options.width||l.innerWidth,c=this.options.height||l.innerHeight;if(this._renderer="canvas2d"==this.options.forceContext?new PIXI.CanvasRenderer(d,c,null,o):"webgl"==this.options.forceContext?new PIXI.WebGLRenderer(d,c,null,o,r):PIXI.autoDetectRenderer(d,c,null,o,r),u.appendChild(this._renderer.view),u.setAttribute("style","position:relative;width:"+d+"px;height:"+c+"px"),this._renderer.clearView=!!this.options.clearView,this.options.showFramerate&&(a=new PIXI.Text("FPS: 0.000",{font:"10px Arial",fill:"black",stroke:"white",strokeThickness:2}),a.x=a.y=5,this.addChild(a)),this._renderer.render(this.stage),h=this.tick.bind(this),g=this.options.raf||!1,this.fps=this.options.fps||60,this.removeApp(),this.options.versionsFile!==t){s=!1;var p=this;n.cacheManager.addVersionsFile(this.options.versionsFile,function(){s=!0,p._app&&(p.addChildAt(p._app,0),p._app.init(),p.resume())})}else s=!0};var f=null,b=null,v="visible",m="hidden",y=function(t){f="hidden",f in document?document.addEventListener("visibilitychange",t):(f="mozHidden")in document?document.addEventListener("mozvisibilitychange",t):(f="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",t):(f="msHidden")in document?document.addEventListener("msvisibilitychange",t):"onfocusin"in document?(b={focusin:v,focusout:m},document.onfocusin=document.onfocusout=t):(b={focus:v,pageshow:v,blur:m,pagehide:m},window.onpageshow=window.onpagehide=window.onfocus=window.onblur=t)},w=function(t){var e="hidden";e in document?document.removeEventListener("visibilitychange",t):(e="mozHidden")in document?document.removeEventListener("mozvisibilitychange",t):(e="webkitHidden")in document?document.removeEventListener("webkitvisibilitychange",t):(e="msHidden")in document&&document.removeEventListener("msvisibilitychange",t),document.onfocusin=document.onfocusout=null,window.onpageshow=window.onpagehide=window.onfocus=window.onblur=null};i.onWindowVisibilityChanged=function(t){var e="visible",i="hidden";t=t||window.event;var n;n=b?b[t.type]:document[f]?i:e,n==i?this.pause():this.resume()};var k=function(t){var e=window.location.href,i=e.indexOf("?");if(-1==i)return t;var n=0>i?"":e.substr(i+1),s=n.indexOf("#");n=0>s?n:n.substring(0,s);for(var a,o=n.split("&"),r=0;r<o.length;r++)a=o[r].split("="),t[a[0]]=a[1];return t};i.pause=function(){-1!=c&&(g?window.cancelAnimationFrame&&cancelAnimationFrame(c):clearTimeout(c),c=-1),n=!0};var S=window.performance&&(performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow);S=S?S.bind(performance):function(){return(new Date).getTime()},i.getTime=function(){return S()},i.resume=function(){n=!1,-1==c&&(c=g?requestAnimFrame(h):C(h)),r=o=this.getTime()},Object.defineProperty(i,"fps",{get:function(){return p},set:function(t){"number"==typeof t&&(p=t,_=1e3/p|0)}}),Object.defineProperty(i,"stageWidth",{get:function(){return d._renderer.view.width}}),Object.defineProperty(i,"stageHeight",{get:function(){return d._renderer.view.height}});var C=function(t,e){var i=0;return e&&(i=Math.max(0,_-e)),setTimeout(t,i)};i.removeApp=function(t){var e=!1,i=this.stage;return this._app&&(this._app.parent==this&&this.removeChild(this._app),i.removeChildren(),this._app.destroy(),e=!0),this._app=null,this.pause(),t||(i.addChild(this),a&&(a.text="FPS: 0.000"),o=r=l=u=0,this._renderer.render(i)),e},i.addApp=function(t){if(this.removeApp(),!(t instanceof cloudkid.Application))throw new Error("Can only objects that inherit cloudkid.Application");this._app=t,s&&(this.addChildAt(t,0),this._app.init(),this.resume())},i.getApp=function(){return this._app},i.addUpdateCallback=function(e,i){this._updateFunctions[e]===t&&(this._updateFunctions[e]=i)},i.removeUpdateCallback=function(e){this._updateFunctions[e]!==t&&delete this._updateFunctions[e]},i.tick=function(){if(n)return void(c=-1);var t=this.getTime(),e=t-o;if(a&&a.visible){u++;var i=t-r;i>1e3&&(l=1e3/i*u,a.setText("FPS: "+Math.round(1e3*l)/1e3),r=t,u=0)}o=t,this._app&&this._app.update(e);for(var s in this._updateFunctions)this._updateFunctions[s](e);this._renderer.render(this.stage),c=g?requestAnimFrame(h):C(h,this.getTime()-o)},i.resize=function(t,e){this._renderer.resize(t,e),this.canvasContainer.setAttribute("style","position:relative;width:"+t+"px;height:"+e+"px")},i.destroy=function(){var t=this.stage,e=cloudkid.MediaLoader.instance;this.pause(),this.removeApp(!0),d=null,e.destroy(),this.stage=null,this._updateFunctions=null,w(this.visibleListener),this.removeChildren(!0),t.destroy(),this._renderer.destroy(),this._renderer=null,this.canvasContainer=null},Object.defineProperty(e,"instance",{get:function(){if(!d)throw"Call cloudkid.OS.init(canvasId)";return d}}),namespace("cloudkid").OS=e}(),function(){"use strict";var t={},e="undefined"!=typeof window.Storage,i=-1;if(e)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST")}catch(n){e=!1}Object.defineProperty(t,"useWebStorage",{get:function(){return e},set:function(t){if(t&&"undefined"!=typeof window.Storage)try{localStorage.setItem("LS_TEST","test"),localStorage.removeItem("LS_TEST"),e=!0}catch(i){e=!1}else e=!1}}),t.remove=function(n){e?(localStorage.removeItem(n),sessionStorage.removeItem(n)):t.write(n,"",i)},t.write=function(t,n,s){if(e)s?sessionStorage.setItem(t,JSON.stringify(n)):localStorage.setItem(t,JSON.stringify(n));else{var a;a=s?s!==i?"":"; expires=Thu, 01 Jan 1970 00:00:00 GMT":"; expires="+new Date(2147483646e3).toGMTString(),document.cookie=t+"="+escape(JSON.stringify(n))+a+"; path=/"}},t.read=function(t){if(e){var i=localStorage.getItem(t)||sessionStorage.getItem(t);return i?JSON.parse(i):null}var n,s=t+"=",a=document.cookie.split(";"),o=0;for(o=0;o<a.length;o++){for(n=a[o];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(s))return JSON.parse(unescape(n.substring(s.length,n.length)))}return null},namespace("cloudkid").SavedData=t}(),function(){"use strict";window.URL=window.URL||window.webkitURL,window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;var Worker={};Worker.init=function(t){if(!window.URL||!window.Worker)return new FallbackWorker(t);var e;try{e=new Blob([t],{type:"application/javascript"})}catch(i){if(!window.BlobBuilder)return new FallbackWorker(t);try{e=new BlobBuilder,e.append(t),e=e.getBlob()}catch(n){return new FallbackWorker(t)}}if(!e)return new FallbackWorker(t);try{var s=new Worker(URL.createObjectURL(e));return s}catch(i){return new FallbackWorker(t)}},namespace("cloudkid").createWorker=Worker.init,namespace("cloudkid").Worker=Worker;var SubWorker=function(codeString,parent){this._wParent=parent,eval(codeString)},p=SubWorker.prototype;p.onmessage=null,p._wParent=null,p.postMessage=function(t){var e=this._wParent;setTimeout(e.onmessage.bind(e,{data:t}),1)};var FallbackWorker=function(t){this._wChild=new SubWorker(t,this)};p=FallbackWorker.prototype,p.postMessage=function(t){var e=this._wChild;setTimeout(e.onmessage.bind(e,{data:t}),1)},p.terminate=function(){this.onmessage=null;var t=this._wChild;t._wParent=null,t.onmessage=null,this._wChild=null},p.onmessage=null,p._wChild=null}(),function(){"use strict";var t=function(t,e,i,n){e[i]?e[n]=t:t()};t.create=function(e,i,n,s){return t.bind(this,e,i,n,s)},namespace("cloudkid").CombinedCallback=t}(),function(t){"use strict";var e=0,i=function(i,n,s,a){this._callback=i,this._delay=n,this._timer=n,this._repeat=!!s,this._autoDestroy=a===t?!0:!!a,this._updateId="DelayedCall#"+ ++e,this._paused=!1,this._update=this._update.bind(this),cloudkid.OS.instance.addUpdateCallback(this._updateId,this._update)},n=i.prototype;n._update=function(t){return this._callback?(this._timer-=t,void(this._timer<=0&&(this._callback(),this._repeat?this._timer+=this._delay:this._autoDestroy?this.destroy():cloudkid.OS.instance.removeUpdateCallback(this._updateId)))):void this.destroy()},n.restart=function(){if(this._callback){var t=cloudkid.OS.instance;t.hasUpdateCallback(this._updateId)||t.addUpdateCallback(this._updateId,this._update),this._timer=this._delay,this._paused=!1}},n.stop=function(){cloudkid.OS.instance.removeUpdateCallback(this._updateId),this._paused=!1},Object.defineProperty(n,"paused",{get:function(){return this._paused},set:function(t){if(this._callback){var e=cloudkid.OS.instance;this._paused&&!t?(this._paused=!1,e.hasUpdateCallback(this._updateId)||e.addUpdateCallback(this._updateId,this._update)):t&&e.hasUpdateCallback(this._updateId)&&(this._paused=!0,e.removeUpdateCallback(this._updateId))}}}),n.destroy=function(){cloudkid.OS.instance.removeUpdateCallback(this._updateId),this._callback=null},namespace("cloudkid").DelayedCall=i}(),function(){"use strict";var t,e=function(){PIXI.DisplayObjectContainer.call(this)};t=e.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),t.init=function(){},t.update=function(){},t.destroy=function(){},t.resize=function(){},namespace("cloudkid").Application=e}(),function(){"use strict";var t=function(){},e=t.prototype;t.PRIORITY_HIGH=1,t.PRIORITY_NORMAL=0,t.PRIORITY_LOW=-1,e.url=null,e.data=null,e.callback=null,e.priority=0,e.progress=0,e.updateCallback=null,e._boundFail=null,e._boundProgress=null,e._boundComplete=null,e.toString=function(){return"[LoaderQueueItem(url:'"+this.url+"', priority:"+this.priority+")]"},e.destroy=function(){this.callback=null,this.updateCallback=null,this.data=null,this._boundFail=null,this._boundProgress=null,this._boundComplete=null},namespace("cloudkid").LoaderQueueItem=t}(),function(){"use strict";var t=function(){},e=t.prototype;t._instance=null;var n=null,s=null,a=null,o=null,r=null,l=null,u=0,h=null;e._canLoad=!0,e.maxSimultaneousLoads=2,e.cacheManager=null,t.init=function(){return t._instance||(t._instance=new t,t._instance._initialize()),t._instance},Object.defineProperty(t,"instance",{get:function(){if(!t._instance)throw"Call cloudkid.MediaLoader.init()";return t._instance}}),e.destroy=function(){var e,i,u,d=this.queue;if(d){for(e=0,i=d.length;e>e;++e)d[e].destroy();for(d=o,e=0,i=d.length;e>e;++e)d[e].destroy();for(d=l,e=0,i=d.length;e>e;++e)d[e].destroy();for(u in a)s[u].destroy(),a[u].close()}t._instance=null,this.cacheManager&&this.cacheManager.destroy(),this.cacheManager=null,n=null,l=null,r=null,o=null,s=null,h=null,a=null},e._initialize=function(){o=[],r=[],l=[],n=[],s={},a={},h={},this.cacheManager=new cloudkid.CacheManager},e.load=function(t,e,i,s,a){var o=this._getQI(),r=cloudkid.OS.instance.options.basePath;void 0!==r&&/^http(s)?\:/.test(t)===!1&&-1==t.search(r)&&(o.basePath=r),o.url=t,o.callback=e,o.updateCallback=i||null,o.priority=s||cloudkid.LoaderQueueItem.PRIORITY_NORMAL,o.data=a||null,n.push(o),n.sort(function(t,e){return t.priority-e.priority}),this._tryNextLoad()},e._onLoadFailed=function(t,e){Debug.error("Unable to load file: "+t.url+" - reason: "+e.error);var i=a[t.url];i.removeAllEventListeners(),i.close(),this._poolLoader(i),delete s[t.url],delete a[t.url],h[t.url]?h[t.url]++:h[t.url]=1,h[t.url]>3?this._loadDone(t,null):(u--,n.push(t),this._tryNextLoad())},e._onLoadProgress=function(t,e){t.progress=e.progress,t.updateCallback&&t.updateCallback(t.progress)},e._onLoadCompleted=function(t,e){var i=a[t.url];i.removeAllEventListeners(),i.close(),this._poolLoader(i),delete s[t.url],delete a[t.url],this._loadDone(t,this._getResult(e.result,t.url,i))},e._tryNextLoad=function(){if(!(u>this.maxSimultaneousLoads-1||0===n.length)){u++;var t=n.shift();s[t.url]=t;var e=this._getLoader(t.basePath);a[t.url]=e,e.addEventListener("fileload",t._boundComplete),e.addEventListener("error",t._boundFail),e.addEventListener("fileprogress",t._boundProgress);var i=this.cacheManager.prepare(t.url);e.loadFile(t.data?{id:t.data.id,src:i,data:t.data}:i)}},e._loadDone=function(t,e){u--,t.data&&e&&(e.id=t.data.id),t.callback(e),this._poolQI(t),this._tryNextLoad()},e.cancel=function(t){var e=s[t],o=a[t];if(e&&o)return o.close(),delete a[t],delete s[e.url],u--,this._poolLoader(o),this._poolQI(e),!0;for(i=0,len=n.length;len>i;i++)if(e=n[i],e.url==t)return n.splice(i,1),this._poolQI(e),!0;return!1},e._getQI=function(){var t;return o.length?t=o.pop():(t=new cloudkid.LoaderQueueItem,t._boundFail=this._onLoadFailed.bind(this,t),t._boundProgress=this._onLoadProgress.bind(this,t),t._boundComplete=this._onLoadCompleted.bind(this,t)),t},e._poolQI=function(t){o.push(t),t.callback=t.updateCallback=t.data=t.url=null,t.progress=0},e._getLoader=function(t){var e;return r.length?(e=r.pop(),e._basePath=t):e=new createjs.LoadQueue(!0,t),createjs.Sound&&e.installPlugin(createjs.Sound),e},e._poolLoader=function(t){t.removeAll(),r.push(t)},e._getResult=function(t,e,i){var n;return l.length?(n=l.pop(),n.content=t,n.url=e,n.loader=i):n=new cloudkid.MediaLoaderResult(t,e,i),n},e._poolResult=function(t){t.content=t.url=t.loader=t.id=null,l.push(t)},namespace("cloudkid").MediaLoader=t}(),function(){"use strict";var t=function(t,e,i){this.content=t,this.url=e,this.loader=i},e=t.prototype;e.content=null,e.url=null,e.loader=null,e.toString=function(){return"[MediaLoaderResult('"+this.url+"')]"},e.destroy=function(){this.callback=null,this.url=null,this.content=null},namespace("cloudkid").MediaLoaderResult=t}(),function(t){"use strict";var e=function(){this.initialize()},i=e.prototype={};i._versions=null,i.cacheBust=!1,i.initialize=function(){this._versions=[];var t=cloudkid.OS.instance.options.cacheBust;this.cacheBust=t?"true"===t||t===!0:!1},i.destroy=function(){this._versions=null},i.addVersionsFile=function(t,e,i){Debug.assert(/^.*\.txt$/.test(t),"The versions file must be a *.txt file");var n=cloudkid.MediaLoader.instance;if(this.cacheBust)return void(e&&e());this.addVersion(t,Math.round(1e5*Math.random()));var s=this;n.load(t,function(t){if(t&&t.content){var n,a,o=t.content.replace(/\r/g,"").split("\n");for(n=0;n<o.length;n++)o[n]&&(a=o[n].split(" "),2==a.length&&s.addVersion((i||"")+a[0],a[1]))}e&&e()})},i.addVersion=function(t,e){var i=this._getVersionByUrl(t);i||this._versions.push({url:t,version:e})},i._getVersionByUrl=function(t){var e,i=this._versions.length;for(e=0;i>e;e++)if(t==this._versions[e].url)return this._versions[e];return null},i.prepare=function(e,i){var n=this._getVersionByUrl(e);if(this.cacheBust&&/(\?|\&)cb\=[0-9]*/.test(e)===!1?(this._cbVal||(this._cbVal=(new Date).getTime().toString()),e=e+(e.indexOf("?")<0?"?":"&")+"cb="+this._cbVal):n&&/(\?|\&)v\=[0-9]*/.test(e)===!1&&(e=e+(e.indexOf("?")<0?"?":"&")+"v="+n.version),i){var s=cloudkid.OS.instance.options.basePath;/^http(s)?\:/.test(e)===!1&&s!==t&&-1==e.search(s)&&(e=s+e)}return e},namespace("cloudkid").CacheManager=e}(),function(t){"use strict";function e(t){if(!t||"object"!=typeof t)return null;var e=t.constructor();for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function i(t,e){if(t===e)return!0;for(var i in t)if(t[i]!=e[i])return!1;return!0}var n=function(t,e,i){t&&(PIXI.DisplayObjectContainer.call(this),this.initialize(t,e,i))},s=n.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);s.back=null,s.label=null,s.releaseCallback=null,s.overCallback=null,s.outCallback=null,s._stateFlags=null,s._statePriority=null,s._stateData=null,s._currentLabelStyle=null,s._offset=null,s._overCB=null,s._outCB=null,s._downCB=null,s._upCB=null,s._upOutCB=null,s._width=0,s._height=0;var a=["disabled","enabled","up","over","down"],o=["disabled","down","over","up"];s.initialize=function(i,n,s){this.back=new PIXI.Sprite(i.up),this.addChild(this.back),this._overCB=this._onOver.bind(this),this._outCB=this._onOut.bind(this),this._downCB=this._onDown.bind(this),this._upCB=this._onUp.bind(this),this._upOutCB=this._onUpOutside.bind(this);var a=this._stateData={};this._stateFlags={},this._offset=new PIXI.Point;var r;if(n){r=e(n),delete r.text,delete r.type,r.x===t&&(r.x="center"),r.y===t&&(r.y="center");var l=r.style=e(n.style);"bitmap"==n.type?l.align=l.align||"left":(l.font=l.font||"bold 20pt Arial",l.fill=l.fill||"black",l.align=l.align||"left",l.stroke=l.stroke||"black",l.strokeThickness=l.strokeThickness||0,l.wordWrap=l.wordWrap||!1,l.wordWrapWidth=l.wordWrapWidth||100)}this._statePriority=i.priority||o;for(var u=this._statePriority.length-1;u>=0;--u){var h=this._statePriority[u];this._addProperty(h),"disabled"!=h&&"up"!=h&&(this._stateFlags[h]=!1);var d=i[h];if(a[h]=d?d.tex?{tex:d.tex}:{tex:d}:a.up,n)if(d&&d.label){d=d.label;var c=a[h].label={};c.style=d.style||r.style,c.x=d.x||r.x,c.y=d.y||r.y}else a[h].label=r}if(a.up||(Debug.error("Button lacks an up state! This is a serious problem! Input data follows:"),Debug.error(i)),a.over||(a.over=a.up),a.down||(a.down=a.up),a.disabled||(a.disabled=a.up),i.offset?(this._offset.x=i.offset.x,this._offset.y=i.offset.y):this._offset.x=this._offset.y=0,i.scale){var g=i.scale||1;this.back.scale.x=this.back.scale.y=g}n&&(this.label="bitmap"==n.type?new PIXI.BitmapText(n.text,r.style):new PIXI.Text(n.text,r.style),this.addChild(this.label)),this.back.x=this._offset.x,this.back.y=this._offset.y,this._width=this.back.width,this._height=this.back.height,this.enabled=s===t?!0:!!s},Object.defineProperty(s,"width",{get:function(){return this._width*this.scale.x},set:function(t){this.scale.x=t/this._width}}),Object.defineProperty(s,"height",{get:function(){return this._height*this.scale.y},set:function(t){this.scale.y=t/this._height}}),s.setText=function(t){if(this.label){this.label.setText(t),this.label instanceof PIXI.Text?(this.label.updateText(),this.label.dirty=!1):this.label.forceUpdateText();for(var e,i=0;i<this._statePriority.length;++i)if(this._stateFlags[this._statePriority[i]]){e=this._stateData[this._statePriority[i]];break}if(e||(e=this._stateData.up),e=e.label,"center"==e.x){var n=this.back.width,s=this.label.width;switch(this._currentLabelStyle.align){case"center":this.label.position.x=.5*n;break;case"right":this.label.position.x=.5*(n-s)+s;break;default:this.label.position.x=.5*(n-s)}}else this.label.position.x=e.x+this._offset.x;this.label.position.y="center"==e.y?.5*(this.back.height-this.label.height):e.y+this._offset.y}},Object.defineProperty(s,"enabled",{get:function(){return!this._stateFlags.disabled},set:function(t){this._stateFlags.disabled=!t,this.buttonMode=t,this.interactive=t,t?(this.mousedown=this.touchstart=this._downCB,this.mouseover=this._overCB,this.mouseout=this._outCB):(this.mousedown=this.touchstart=this.mouseover=this.mouseout=null,this.mouseup=this.touchend=this.mouseupoutside=this.touchendoutside=null,this._stateFlags.down=this._stateFlags.over=!1,this.__isOver=!1),this._updateState()}}),s._addProperty=function(t){a.indexOf(t)>=0||Object.defineProperty(this,t,{get:function(){return this._stateFlags[t]},set:function(e){this._stateFlags[t]=e,this._updateState()}})},s._updateState=function(){if(this.back){for(var t,e=0;e<this._statePriority.length;++e)if(this._stateFlags[this._statePriority[e]]){t=this._stateData[this._statePriority[e]];break}if(t||(t=this._stateData.up),this.back.setTexture(t.tex),this.label){if(t=t.label,this._currentLabelStyle&&i(this._currentLabelStyle,t.style)||(this.label.setStyle(t.style),this._currentLabelStyle=t.style,this.label instanceof PIXI.Text?(this.label.updateText(),this.label.dirty=!1):this.label.forceUpdateText()),"center"==t.x){var n=this.back.width,s=this.label.width;switch(this._currentLabelStyle.align){case"center":this.label.position.x=.5*n;break;case"right":this.label.position.x=.5*(n-s)+s;break;default:this.label.position.x=.5*(n-s)}}else this.label.position.x=t.x+this._offset.x;this.label.position.y="center"==t.y?.5*(this.back.height-this.label.height):t.y+this._offset.y}}},s._onOver=function(){this._stateFlags.over=!0,this._updateState(),this.overCallback&&this.overCallback(this)},s._onOut=function(){this._stateFlags.over=!1,this._updateState(),this.outCallback&&this.outCallback(this)},s._onDown=function(t){t.originalEvent.preventDefault(),this._stateFlags.down=!0,this._updateState(),this.mouseup=this.touchend=this._upCB,this.mouseupoutside=this.touchendoutside=this._upOutCB},s._onUp=function(t){t.originalEvent.preventDefault(),this._stateFlags.down=!1,this.mouseup=this.touchend=null,this.mouseupoutside=this.touchendoutside=null,this._updateState(),this.releaseCallback&&this.releaseCallback(this)},s._onUpOutside=function(){this._stateFlags.down=!1,this.mouseup=this.touchend=null,this.mouseupoutside=this.touchendoutside=null,this._updateState()},s.destroy=function(){this.mousedown=this.touchstart=this.mouseover=this.mouseout=null,this.mouseup=this.touchend=this.mouseupoutside=this.touchendoutside=null,this.removeChildren(!0),this.label=null,this.back=null,this.releaseCallback=null,this.overCallback=null,this.outCallback=null,this._stateData=null,this._stateFlags=null,this._statePriority=null,this._downCB=null,this._upCB=null,this._overCB=null,this._outCB=null,this._upOutCB=null},namespace("cloudkid").Button=n}(),function(){"use strict";var t=function(t,e){this.initialize(t,e)},e=t.prototype={};e.draggedObj=null,e.dragStartThreshold=20,e.mouseDownStagePos=null,e.mouseDownObjPos=null,e.isTouchMove=!1,e.isHeldDrag=!1,e.isStickyClick=!1,e.allowStickyClick=!0,e.snapSettings=null,e._theStage=null,e._dragOffset=null,e._dragStartCallback=null,e._dragEndCallback=null,e._triggerHeldDragCallback=null,e._triggerStickyClickCallback=null,e._stageMouseUpCallback=null,e._updateCallback=null,e._draggableObjects=null;var i=null,n=0,s=1;e.initialize=function(t,e){this._updateCallback=this._updateObjPosition.bind(this),this._triggerHeldDragCallback=this._triggerHeldDrag.bind(this),this._triggerStickyClickCallback=this._triggerStickyClick.bind(this),this._stageMouseUpCallback=this._stopDrag.bind(this),this._theStage=cloudkid.OS.instance.stage,this._dragStartCallback=t,this._dragEndCallback=e,this._draggableObjects=[],this.mouseDownStagePos=new PIXI.Point(0,0),this.mouseDownObjPos=new PIXI.Point(0,0),i=new PIXI.Point(0,0)},e.startDrag=function(t,e){this._objMouseDown(n,t,e)},e._objMouseDown=function(t,e,i){null===this.draggedObj&&(this.draggedObj=e,createjs.Tween.removeTweens(this.draggedObj),createjs.Tween.removeTweens(this.draggedObj.position),this._dragOffset=i.getLocalPosition(this.draggedObj.parent),this._dragOffset.x-=this.draggedObj.position.x,this._dragOffset.y-=this.draggedObj.position.y,this.mouseDownObjPos.x=this.draggedObj.position.x,this.mouseDownObjPos.y=this.draggedObj.position.y,this.mouseDownStagePos.x=i.global.x,this.mouseDownStagePos.y=i.global.y,this.allowStickyClick&&t!=s?(this.draggedObj.mousemove=this._triggerHeldDragCallback,this._theStage.interactionManager.stageUp=this._triggerStickyClickCallback):(this.isTouchMove=t==s,this.isHeldDrag=!0,this._startDrag()))},e._triggerStickyClick=function(){this.isStickyClick=!0,this.draggedObj.mousemove=null,this._theStage.interactionManager.stageUp=null,this._startDrag()},e._triggerHeldDrag=function(t){var e=t.global.x-this.mouseDownStagePos.x,i=t.global.y-this.mouseDownStagePos.y;e*e+i*i>=this.dragStartThreshold*this.dragStartThreshold&&(this.isHeldDrag=!0,this.draggedObj.mousemove=null,this._theStage.interactionManager.stageUp=null,this._startDrag())},e._startDrag=function(){var t=this._theStage.interactionManager;t.stageUp=this._stageMouseUpCallback,this.draggedObj.mousemove=this.draggedObj.touchmove=this._updateCallback,this._dragStartCallback(this.draggedObj)},e.stopDrag=function(t){this._stopDrag(null,t===!0)},e._stopDrag=function(t,e){this.draggedObj&&(this.draggedObj.touchmove=this.draggedObj.mousemove=null);var i=this._theStage.interactionManager;i.stageUp=null;var n=this.draggedObj;this.draggedObj=null,this.isTouchMove=!1,this.isStickyClick=!1,this.isHeldMove=!1,e!==!1&&this._dragEndCallback(n)},e._updateObjPosition=function(t){if(this.isTouchMove||this._theStage.interactionManager.mouseInStage){if(!this.draggedObj||!this.draggedObj.parent)return void this._stopDrag(null,!1);var e=t.getLocalPosition(this.draggedObj.parent,i),n=this.draggedObj._dragBounds;if(this.draggedObj.position.x=o(e.x-this._dragOffset.x,n.x,n.right),this.draggedObj.position.y=o(e.y-this._dragOffset.y,n.y,n.bottom),this.snapSettings)switch(this.snapSettings.mode){case"points":this._handlePointSnap(e);break;case"grid":break;case"line":}}},e._handlePointSnap=function(t){for(var e=this.snapSettings,i=e.dist*e.dist,n=e.points,s=t.x-this._dragOffset.x,o=t.y-this._dragOffset.y,r=-1,l=null,u=n.length-1;u>=0;--u){var h=n[u],d=a(s,o,h.x,h.y);i>=d&&(r>d||-1==r)&&(r=d,l=h)}l&&(this.draggedObj.position.x=l.x,this.draggedObj.position.y=l.y)};var a=function(t,e,i,n){var s=t-i,a=e-n;return s*s+a*a},o=function(t,e,i){return e>t?e:t>i?i:t},r=function(){this.mousedown=this._onMouseDownListener,this.touchstart=this._onTouchStartListener,this.buttonMode=this.interactive=!0},l=function(){this.mousedown=this.touchstart=null,this.buttonMode=this.interactive=!1},u=function(t,e){this._dragMan._objMouseDown(t,this,e)};e.addObject=function(t,e){if(!e){var i=cloudkid.OS.instance._renderer.view;e={x:0,y:0,width:i.width,height:i.height}}e.right=e.x+e.width,e.bottom=e.y+e.height,t._dragBounds=e,this._draggableObjects.indexOf(t)>=0||(t.enableDrag=r,t.disableDrag=l,t._onMouseDownListener=u.bind(t,n),t._onTouchStartListener=u.bind(t,s),t._dragMan=this,this._draggableObjects.push(t))},e.removeObject=function(t){var e=this._draggableObjects.indexOf(t);e>=0&&(t.disableDrag(),delete t.enableDrag,delete t.disableDrag,delete t._onMouseDownListener,delete t._onTouchStartListener,delete t._dragMan,delete t._dragBounds,this._draggableObjects.splice(e,1))},e.destroy=function(){null!==this.draggedObj&&this._stopDrag(null,!1),this._updateCallback=null,this._dragStartCallback=null,this._dragEndCallback=null,this._triggerHeldDragCallback=null,this._triggerStickyClickCallback=null,this._stageMouseUpCallback=null,this._theStage=null;for(var t=this._draggableObjects.length-1;t>=0;--t){var e=this._draggableObjects[t];e.disableDrag(),delete e.enableDrag,delete e.disableDrag,delete e._onMouseDownListener,delete e._dragMan,delete e._dragBounds}this._draggableObjects=null},namespace("cloudkid").DragManager=t}(),function(){"use strict";var t=function(){};t.prototype={},t.positionItems=function(e,i){var n,s,a;a=Math.PI/180;for(var o in i){var r=e[o];if(r){var l=i[o];if(r.position.x=l.x,r.position.y=l.y,s=l.scale,s&&(r.scale.x*=s.x,r.scale.y*=s.y),s=l.pivot,s&&(r.pivot.x=s.x,r.pivot.y=s.y),n=l.rotation,n&&(r.rotation=n*a),l.hitArea){var u=l.hitArea;r.hitArea=t.generateHitArea(u)}}else Debug.error("could not find object '"+o+"'")}},t.generateHitArea=function(t,i){i||(i=1);var n;if(n=window.PIXI,e(t)){if(1==i)return new n.Polygon(t);for(var s=[],a=0,o=t.length;o>a;++a)s.push(new n.Point(t[a].x*i,t[a].y*i));return new n.Polygon(s)}return"rect"!=t.type&&t.type?"ellipse"==t.type?new n.Ellipse((t.x-.5*t.w)*i,(t.y-.5*t.h)*i,t.w*i,t.h*i):"circle"==t.type?new n.Circle(t.x*i,t.y*i,t.r*i):"sector"==t.type?new n.Sector(t.x*i,t.y*i,t.r*i,t.start,t.end):null:new n.Rectangle(t.x*i,t.y*i,t.w*i,t.h*i)};var e=function(t){return"[object Array]"===Object.prototype.toString.call(t)};namespace("cloudkid").Positioner=t}(),function(){"use strict";var t=function(t,e,i){this.width=t,this.height=e,this.ppi=i};t.prototype={},namespace("cloudkid").ScreenSettings=t}(),function(){"use strict";var t,e=function(e,i,n){switch(t=cloudkid.UIScaler,this._item=e,this._settings=i,this._designedScreen=n,this.origScaleX=e.scale.x,this.origScaleY=e.scale.y,this.origWidth=e.width,this.origBounds={x:0,y:0,width:e.width,height:e.height},this.origBounds.right=this.origBounds.x+this.origBounds.width,this.origBounds.bottom=this.origBounds.y+this.origBounds.height,i.vertAlign){case t.ALIGN_TOP:this.origMarginVert=e.position.y+this.origBounds.y;break;case t.ALIGN_CENTER:this.origMarginVert=.5*n.height-e.position.y;break;case t.ALIGN_BOTTOM:this.origMarginVert=n.height-(e.position.y+this.origBounds.bottom)}switch(i.horiAlign){case t.ALIGN_LEFT:this.origMarginHori=e.position.x+this.origBounds.x;break;case t.ALIGN_CENTER:this.origMarginHori=.5*n.width-e.position.x;break;case t.ALIGN_RIGHT:this.origMarginHori=n.width-(e.position.x+this.origBounds.right)}},i=e.prototype={};i.origMarginHori=0,i.origMarginVert=0,i.origWidth=0,i.origScaleX=0,i.origScaleY=0,i.origBounds=null,i._settings=null,i._item=null,i._designedScreen=null,i.resize=function(e){var i=e.height/this._designedScreen.height,n=e.ppi/this._designedScreen.ppi,s=(e.width-this._designedScreen.width*i)/2,a=i/n;this._settings.minScale&&a<this._settings.minScale?a=this._settings.minScale:this._settings.maxScale&&a>this._settings.maxScale&&(a=this._settings.maxScale),a*=n,this._item.scale.x=this.origScaleX*a,this._item.scale.y=this.origScaleY*a;var o;switch(o=this.origMarginVert*i,this._settings.vertAlign){case t.ALIGN_TOP:this._item.position.y=o-this.origBounds.y*a;break;case t.ALIGN_CENTER:this._item.position.y=.5*e.height-o;break;case t.ALIGN_BOTTOM:this._item.position.y=e.height-o-this.origBounds.bottom*a}switch(o=this.origMarginHori*i,this._settings.horiAlign){case t.ALIGN_LEFT:this._item.position.x=this._settings.titleSafe?s+o-this.origBounds.x*a:o-this.origBounds.x*a;break;case t.ALIGN_CENTER:this._item.position.x=this._settings.centeredHorizontally?.5*(e.width-this._item.width):.5*e.width-o;break;case t.ALIGN_RIGHT:this._item.position.x=this._settings.titleSafe?e.width-s-o-this.origBounds.right*a:e.width-o-this.origBounds.right*a}},i.destroy=function(){this.origBounds=null,this._item=null,this._settings=null,this._designedScreen=null},namespace("cloudkid").UIElement=e}(),function(){"use strict";var t=function(){},e=t.prototype={};e.vertAlign=null,e.horiAlign=null,e.titleSafe=!1,e.maxScale=1,e.minScale=1,e.centeredHorizontally=!1,namespace("cloudkid").UIElementSettings=t}(),function(){"use strict";var t=cloudkid.UIElementSettings,e=cloudkid.UIElement,i=cloudkid.ScreenSettings,n=function(t,e,n,s){this._parent=t,this._items=[],this._designedScreen=new i(e,n,s)},s=n.prototype={},a=new i(0,0,0),o=!1;s._parent=null,s._designedScreen=null,s._items=null,n.ALIGN_TOP="top",n.ALIGN_BOTTOM="bottom",n.ALIGN_LEFT="left",n.ALIGN_RIGHT="right",n.ALIGN_CENTER="center",n.fromJSON=function(t,e,i,s){"boolean"!=typeof s&&(s=!0);var a,o,r,l,u,h=new n(t,e.designedWidth,e.designedHeight,e.designedPPI);for(o in i)a=i[o],a.align?(r=a.align.split("-"),l=r[0],u=r[1]):(l=ALIGN_CENTER,u=ALIGN_CENTER),h.add(t[o],l,u,a.titleSafe||!1,a.minScale||0/0,a.maxScale||0/0,a.centeredHorizontally||!1);return h.resize(),s&&h.destroy(),h},n.init=function(t,e,i){a.width=t,a.height=e,a.ppi=i,o=!0},s.getScale=function(){return a.height/this._designedScreen.height},s.add=function(i,s,a,o,r,l,u){var h=new t;h.vertAlign=s||n.ALIGN_CENTER,h.horiAlign=a||n.ALIGN_CENTER,h.titleSafe="boolean"!=typeof o?!1:o,h.maxScale="number"!=typeof l?0/0:l,h.minScale="number"!=typeof r?0/0:r,h.centeredHorizontally=u||!1,this._items.push(new e(i,h,this._designedScreen))},n.resizeBackground=function(t){if(o){var e,i,n;
e=t.height/t.scale.y,i=t.width/t.scale.x,n=a.height/e,t.scale.x=t.scale.y=n,t.position.x=.5*(a.width-t.width)}},n.resizeBackgrounds=function(t){for(var e=0,i=t.length;i>e;++e)n.resizeBackground(t[e])},s.resize=function(){if(this._items.length>0)for(var t=0,e=this._items.length;e>t;++t)this._items[t].resize(a)},s.destroy=function(){if(this._items.length>0)for(var t=0,e=this._items.length;e>t;++t)this._items[t].destroy();this._parent=null,this._designedScreen=null,this._items=null},namespace("cloudkid").UIScaler=n}(),function(){"use strict";var t={};t.scales=null;var e=null,i=null,n=null,s=null,a=null,o=null;t.lowHW=!1,t.init=function(o,l,u){t.scales={},i=o.assets,n={},a=o.path,e=o.sizing,s=o.scale,r(l,u)},t.getPreferredSize=function(){return o[0]},t.getPreferredScale=function(){return s[o[0]]};var r=function(t,i){for(var n,s=i>t?t:i,a=e.length-1;a>=0&&e[a].maxSize>s;--a)n=e[a];o=n.order};t.getUrl=function(e){var r=i[e];if(!r)return null;if(n[e])return n[e];var l;if(r.anim)return l=n[e]=a.anim+r.src;if(t.lowHW&&r.lowHW)return t.scales[e]=s[r.lowHW],l=n[e]=a[r.lowHW]+r.src;for(var u=0;u<o.length;++u){var h=o[u];if(r[h])return t.scales[e]=s[h],l=n[e]=a[h]+r.src}return null},t.unload=function(t){if(t instanceof Array)for(var e=t.length-1;e>=0;--e){var i=t[e];l(i)}else l(t)};var l=function(e){if(n[e]){var s=i[e];s&&(s.anim||(s.isFont&&PIXI.BitmapText.fonts[e]&&delete PIXI.BitmapText.fonts[e],PIXI.Texture.destroyTexture(n[e]),delete t.scales[e],delete n[e]))}};t.getAnims=function(t,e,i){void 0===e&&(e=4),0>e&&(e=0);var n,s,a=[],o=[];for(n=1;e>n;++n){var r="";s=1;for(var l=0;n>l;++l)r+="0",s*=10;a.unshift(r),o.push(s)}var u,h,d=o.length,c=i||{},g=PIXI.Texture.fromFrame;for(var p in t){var _=t[p],f=[];for(n=_.numberMin,h=_.numberMax;h>=n;++n){var b=null;for(s=0;d>s;++s)if(n<o[s]){b=a[s]+n;break}b||(b=n.toString());var v=_.name.replace("#",b),m=g(v,!0);m&&(u=m),f.push(u)}c[p]=f}return c},namespace("cloudkid").AssetManager=t}();