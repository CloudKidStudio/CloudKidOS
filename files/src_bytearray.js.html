<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/bytearray.js - CloudKid OS API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../cloudkid.png" title="CloudKid OS API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/bind.html">bind</a></li>
            
                <li><a href="../classes/cloudkid.Application.html">cloudkid.Application</a></li>
            
                <li><a href="../classes/cloudkid.Button.html">cloudkid.Button</a></li>
            
                <li><a href="../classes/cloudkid.CacheManager.html">cloudkid.CacheManager</a></li>
            
                <li><a href="../classes/cloudkid.DragManager.html">cloudkid.DragManager</a></li>
            
                <li><a href="../classes/cloudkid.LoaderQueueItem.html">cloudkid.LoaderQueueItem</a></li>
            
                <li><a href="../classes/cloudkid.MediaLoader.html">cloudkid.MediaLoader</a></li>
            
                <li><a href="../classes/cloudkid.MediaLoaderResult.html">cloudkid.MediaLoaderResult</a></li>
            
                <li><a href="../classes/cloudkid.OS.html">cloudkid.OS</a></li>
            
                <li><a href="../classes/cloudkid.PixiAnimator.html">cloudkid.PixiAnimator</a></li>
            
                <li><a href="../classes/cloudkid.PixiAnimator.AnimTimeline.html">cloudkid.PixiAnimator.AnimTimeline</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/bytearray.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
* @preserve
* Adamia 3D Engine v0.1
* Copyright (c) 2010 Adam R. Smith
* Licensed under the new BSD License:
* http://www.opensource.org/licenses/bsd-license.php
*
* Project home: http://code.google.com/p/adamia-3d/
* 
* Date: 01/12/2010
*/

if (typeof(a3d) == &#x27;undefined&#x27;) {
	/** @namespace */ a3d = {};
}

// Taken from http://ejohn.org/blog/simple-javascript-inheritance/

// Inspired by base2 and Prototype
(function(){
  var initializing = false, fnTest = /xyz/.test(function(){xyz;}) ? /\b_super\b/ : /.*/;

  // The base Class implementation (does nothing)
  /** @class */
  this.Class = function(){};
 
  // Create a new Class that inherits from this class
  Class.extend = function(prop) {
    var _super = this.prototype;
   
    // Instantiate a base class (but only create the instance,
    // don&#x27;t run the init constructor)
    initializing = true;
    var prototype = new this();
    initializing = false;
   
    // Copy the properties over onto the new prototype
    for (var name in prop) {
      // Check if we&#x27;re overwriting an existing function
      prototype[name] = typeof prop[name] == &quot;function&quot; &amp;&amp;
        typeof _super[name] == &quot;function&quot; &amp;&amp; fnTest.test(prop[name]) ?
        (function(name, fn){
          return function() {
            var tmp = this._super;
           
            // Add a new ._super() method that is the same method
            // but on the super-class
            this._super = _super[name];
           
            // The method only need to be bound temporarily, so we
            // remove it when we&#x27;re done executing
            var ret = fn.apply(this, arguments);       
            this._super = tmp;
           
            return ret;
          };
        })(name, prop[name]) :
        prop[name];
    }
   
    // The dummy class constructor
    function Class() {
      // All construction is actually done in the init method
      if ( !initializing &amp;&amp; this.init )
        this.init.apply(this, arguments);
    }
   
    // Populate our constructed prototype object
    Class.prototype = prototype;
   
    // Enforce the constructor to be what we expect
    Class.constructor = Class;

    // And make this class extendable
    Class.extend = arguments.callee;
   
    return Class;
  };
})();
/**
 * Enum for big or little endian.
 * @enum {number}
 */
a3d.Endian = {
	  BIG: 0
	, LITTLE: 1
};

/**
 * Attempt to imitate AS3&#x27;s ByteArray as very high-performance javascript.
 * I aliased the functions to have shorter names, like ReadUInt32 as well as ReadUnsignedInt.
 * I used some code from http://fhtr.blogspot.com/2009/12/3d-models-and-parsing-binary-data-with.html
 * to kick-start it, but I added optimizations and support both big and little endian.
 * Note that you cannot change the endianness after construction.
 * @extends Class
 */
a3d.ByteArray = Class.extend({
	  data: &#x27;&#x27;
	, length: 0
	, pos: 0
	, pow: Math.pow
	, endian: a3d.Endian.BIG
	, TWOeN23: Math.pow(2, -23)
	, TWOeN52: Math.pow(2, -52)
	
	/** @constructor */
	, init: function(data, endian) {
		this.data = (data !== undefined) ? data : &#x27;&#x27;;
		if (endian !== undefined) this.endian = endian;
		this.length = data.length;
		
		// Cache the function pointers based on endianness.
		// This avoids doing an if-statement in every function call.
		var funcExt = (endian == a3d.Endian.BIG) ? &#x27;BE&#x27; : &#x27;LE&#x27;;
		var funcs = [&#x27;readInt32&#x27;, &#x27;readInt16&#x27;, &#x27;readUInt32&#x27;, &#x27;readUInt16&#x27;, &#x27;readFloat32&#x27;, &#x27;readFloat64&#x27;];
		for (var func in funcs) {
			this[funcs[func]] = this[funcs[func] + funcExt];
		}
		
		// Add redundant members that match actionscript for compatibility
		var funcMap = {readUnsignedByte: &#x27;readByte&#x27;, readUnsignedInt: &#x27;readUInt32&#x27;,
			readFloat: &#x27;readFloat32&#x27;, readDouble: &#x27;readFloat64&#x27;, readShort: &#x27;readInt16&#x27;,
			readBoolean: &#x27;readBool&#x27;, readInt: &#x27;readInt32&#x27;};
		for (var func in funcMap) {
			this[func] = this[funcMap[func]];
		}
	}
	
	, readByte: function() {
		return (this.data.charCodeAt(this.pos++) &amp; 0xFF);
	}
	
	, readBool: function() {
		return (this.data.charCodeAt(this.pos++) &amp; 0xFF) ? true : false;
	}
	
	, readUInt32BE: function() {
		var data = this.data, pos = (this.pos += 4) - 4;
		return	((data.charCodeAt(pos)   &amp; 0xFF) &lt;&lt; 24) |
				((data.charCodeAt(++pos) &amp; 0xFF) &lt;&lt; 16) |
				((data.charCodeAt(++pos) &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(++pos) &amp; 0xFF);
	}
	, readInt32BE: function() {
		var data = this.data, pos = (this.pos += 4) - 4;
		var x =	((data.charCodeAt(pos)   &amp; 0xFF) &lt;&lt; 24) |
				((data.charCodeAt(++pos) &amp; 0xFF) &lt;&lt; 16) |
				((data.charCodeAt(++pos) &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(++pos) &amp; 0xFF);
		return (x &gt;= 2147483648) ? x - 4294967296 : x;
	}
	
	, readUInt16BE: function() {
		var data = this.data, pos = (this.pos += 2) - 2;
		return	((data.charCodeAt(pos)   &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(++pos) &amp; 0xFF);
	}
	, readInt16BE: function() {
		var data = this.data, pos = (this.pos += 2) - 2;
		var x =	((data.charCodeAt(pos)   &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(++pos) &amp; 0xFF);
		return (x &gt;= 32768) ? x - 65536 : x;
	}
	
	, readFloat32BE: function() {
		var data = this.data, pos = (this.pos += 4) - 4;
		var b1 = data.charCodeAt(pos) &amp; 0xFF,
			b2 = data.charCodeAt(++pos) &amp; 0xFF,
			b3 = data.charCodeAt(++pos) &amp; 0xFF,
			b4 = data.charCodeAt(++pos) &amp; 0xFF;
		var sign = 1 - ((b1 &gt;&gt; 7) &lt;&lt; 1);                   // sign = bit 0
		var exp = (((b1 &lt;&lt; 1) &amp; 0xFF) | (b2 &gt;&gt; 7)) - 127;  // exponent = bits 1..8
		var sig = ((b2 &amp; 0x7F) &lt;&lt; 16) | (b3 &lt;&lt; 8) | b4;    // significand = bits 9..31
		if (sig == 0 &amp;&amp; exp == -127)
			return 0.0;
		return sign*(1 + this.TWOeN23*sig)*this.pow(2, exp);
	}
	
	, readFloat64BE: function() {
		var data = this.data, pos = (this.pos += 8) - 8;
		var b1 = data.charCodeAt(pos) &amp; 0xFF,
			b2 = data.charCodeAt(++pos) &amp; 0xFF,
			b3 = data.charCodeAt(++pos) &amp; 0xFF,
			b4 = data.charCodeAt(++pos) &amp; 0xFF,
			b5 = data.charCodeAt(++pos) &amp; 0xFF,
			b6 = data.charCodeAt(++pos) &amp; 0xFF,
			b7 = data.charCodeAt(++pos) &amp; 0xFF,
			b8 = data.charCodeAt(++pos) &amp; 0xFF;
		var sign = 1 - ((b1 &gt;&gt; 7) &lt;&lt; 1);									// sign = bit 0
		var exp = (((b1 &lt;&lt; 4) &amp; 0x7FF) | (b2 &gt;&gt; 4)) - 1023;					// exponent = bits 1..11
		
		// This crazy toString() stuff works around the fact that js ints are
		// only 32 bits and signed, giving us 31 bits to work with
		var sig = (((b2 &amp; 0xF) &lt;&lt; 16) | (b3 &lt;&lt; 8) | b4).toString(2) +
			((b5 &gt;&gt; 7) ? &#x27;1&#x27; : &#x27;0&#x27;) +
			(((b5&amp;0x7F) &lt;&lt; 24) | (b6 &lt;&lt; 16) | (b7 &lt;&lt; 8) | b8).toString(2);	// significand = bits 12..63
			
		sig = parseInt(sig, 2);
		if (sig == 0 &amp;&amp; exp == -1023)
			return 0.0;
		return sign*(1.0 + this.TWOeN52*sig)*this.pow(2, exp);
	}
	
	, readUInt32LE: function() {
		var data = this.data, pos = (this.pos += 4);
		return	((data.charCodeAt(--pos)   &amp; 0xFF) &lt;&lt; 24) |
				((data.charCodeAt(--pos) &amp; 0xFF) &lt;&lt; 16) |
				((data.charCodeAt(--pos) &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(--pos) &amp; 0xFF);
	}
	, readInt32LE: function() {
		var data = this.data, pos = (this.pos += 4);
		var x =	((data.charCodeAt(--pos)   &amp; 0xFF) &lt;&lt; 24) |
				((data.charCodeAt(--pos) &amp; 0xFF) &lt;&lt; 16) |
				((data.charCodeAt(--pos) &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(--pos) &amp; 0xFF);
		return (x &gt;= 2147483648) ? x - 4294967296 : x;
	}
	
	, readUInt16LE: function() {
		var data = this.data, pos = (this.pos += 2);
		return	((data.charCodeAt(--pos)   &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(--pos) &amp; 0xFF);
	}
	, readInt16LE: function() {
		var data = this.data, pos = (this.pos += 2);
		var x =	((data.charCodeAt(--pos)   &amp; 0xFF) &lt;&lt; 8) |
				 (data.charCodeAt(--pos) &amp; 0xFF);
		return (x &gt;= 32768) ? x - 65536 : x;
	}
	
	, readFloat32LE: function() {
		var data = this.data, pos = (this.pos += 4);
		var b1 = data.charCodeAt(--pos) &amp; 0xFF,
			b2 = data.charCodeAt(--pos) &amp; 0xFF,
			b3 = data.charCodeAt(--pos) &amp; 0xFF,
			b4 = data.charCodeAt(--pos) &amp; 0xFF;
		var sign = 1 - ((b1 &gt;&gt; 7) &lt;&lt; 1);                   // sign = bit 0
		var exp = (((b1 &lt;&lt; 1) &amp; 0xFF) | (b2 &gt;&gt; 7)) - 127;  // exponent = bits 1..8
		var sig = ((b2 &amp; 0x7F) &lt;&lt; 16) | (b3 &lt;&lt; 8) | b4;    // significand = bits 9..31
		if (sig == 0 &amp;&amp; exp == -127)
			return 0.0;
		return sign*(1 + this.TWOeN23*sig)*this.pow(2, exp);
	}
	
	, readFloat64LE: function() {
		var data = this.data, pos = (this.pos += 8);
		var b1 = data.charCodeAt(--pos) &amp; 0xFF,
			b2 = data.charCodeAt(--pos) &amp; 0xFF,
			b3 = data.charCodeAt(--pos) &amp; 0xFF,
			b4 = data.charCodeAt(--pos) &amp; 0xFF,
			b5 = data.charCodeAt(--pos) &amp; 0xFF,
			b6 = data.charCodeAt(--pos) &amp; 0xFF,
			b7 = data.charCodeAt(--pos) &amp; 0xFF,
			b8 = data.charCodeAt(--pos) &amp; 0xFF;
		var sign = 1 - ((b1 &gt;&gt; 7) &lt;&lt; 1);									// sign = bit 0
		var exp = (((b1 &lt;&lt; 4) &amp; 0x7FF) | (b2 &gt;&gt; 4)) - 1023;					// exponent = bits 1..11
		
		// This crazy toString() stuff works around the fact that js ints are
		// only 32 bits and signed, giving us 31 bits to work with
		var sig = (((b2 &amp; 0xF) &lt;&lt; 16) | (b3 &lt;&lt; 8) | b4).toString(2) +
			((b5 &gt;&gt; 7) ? &#x27;1&#x27; : &#x27;0&#x27;) +
			(((b5&amp;0x7F) &lt;&lt; 24) | (b6 &lt;&lt; 16) | (b7 &lt;&lt; 8) | b8).toString(2);	// significand = bits 12..63
			
		sig = parseInt(sig, 2);
		if (sig == 0 &amp;&amp; exp == -1023)
			return 0.0;
		return sign*(1.0 + this.TWOeN52*sig)*this.pow(2, exp);
	}
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
